id: INIT-005
slug: agent-quality-restoration
title: Fix Agent Degradation and Worktree Discipline
description: |
  Agent quality has significantly degraded - agents write to main instead of worktrees,
  don't complete tasks (used to be 9/10), and don't create bugs via mem:triage.

  Primary root cause: wu:spawn output truncation causes ~90% context loss.
  Secondary factors: Fail-open hook bugs, missing recovery guidance.
status: open
priority: P1
owner: tom@hellm.ai
created: 2026-01-26
phases:
  - id: 1
    title: Critical Fix
    description: Fix wu:spawn truncation (root cause)
    status: pending
    wus:
      - WU-1131
  - id: 2
    title: Hook Hardening
    description: Fix fail-open hooks + add audit logging
    status: pending
    wus:
      - WU-1132
  - id: 3
    title: Doc Alignment
    description: Fix broken references + align docs-only language
    status: pending
    wus:
      - WU-1133
  - id: 4
    title: Recovery & Enforcement
    description: Add recovery guidance and prompt-level enforcement
    status: pending
    wus:
      - WU-1134
      - WU-1135
success_metrics:
  - Spawned agents receive full 23-section prompt (end sentinel present)
  - Hook blocks are audited to .claude/audit/main-write-blocks.log
  - Agent task completion rate returns to 9/10
labels:
  - agent-quality
  - worktree-discipline
  - truncation-fix
