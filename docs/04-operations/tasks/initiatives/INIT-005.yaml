id: INIT-005
slug: agent-quality-restoration
title: Fix Agent Degradation and Worktree Discipline
description: |
  Agent quality has significantly degraded - agents write to main instead of worktrees,
  don't complete tasks (used to be 9/10), and don't create bugs via mem:triage.

  Primary root cause: wu:spawn output truncation causes ~90% context loss.
  Secondary factors: Fail-open hook bugs, missing recovery guidance.
status: open
priority: P1
owner: tom@hellm.ai
created: 2026-01-26
phases:
  - id: 1
    title: Critical Fix
    status: pending
  - id: 2
    title: Hook Hardening
    status: pending
  - id: 3
    title: Doc Alignment
    status: pending
  - id: 4
    title: Recovery & Enforcement
    status: pending
success_metrics:
  - Spawned agents receive full 23-section prompt (end sentinel present)
  - Hook blocks are audited to .claude/audit/main-write-blocks.log
  - Agent task completion rate returns to 9/10
labels:
  - agent-quality
  - worktree-discipline
  - truncation-fix
wus:
  - WU-1131
