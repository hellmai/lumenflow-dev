id: WU-1418
title: wu:repair should bypass pre-push hook for admin fixes
lane: 'Operations: Infrastructure'
type: feature
status: done
priority: P2
created: 2026-02-04
code_paths:
  - packages/@lumenflow/core/src/micro-worktree.ts
  - .husky/hooks/pre-push.mjs
tests:
  manual:
    - Run pnpm wu:repair --id WU-XXXX on a WU with status.md inconsistency
    - Verify push completes without LUMENFLOW_FORCE=1 manual intervention
    - Verify pre-push hook allows wu-repair tool pushes
  unit:
    - packages/@lumenflow/cli/__tests__/wu-repair.test.ts
    - packages/@lumenflow/cli/__tests__/pre-push-hook.test.ts
    - packages/@lumenflow/core/src/__tests__/micro-worktree.test.ts
  e2e: []
spec_refs:
  - lumenflow://plans/WU-1418-plan.md
artifacts:
  - .lumenflow/stamps/WU-1418.done
dependencies: []
risks: []
notes: |-


  [ADMIN-REPAIR 2026-02-04]: lane changed from 'Framework: CLI' to 'Operations: Infrastructure'
requires_review: false
assigned_to: tom@hellm.ai
exposure: backend-only
escalation_triggers: []
requires_human_escalation: false
requires_cso_approval: false
requires_cto_approval: false
requires_design_approval: false
description: 'Context: wu:repair detects and fixes state inconsistencies (e.g., status.md out of
  sync with YAML). Problem: The repair commit gets blocked by the pre-push hook that prevents direct
  main pushes. Currently requires manual LUMENFLOW_FORCE=1 git push. Solution: wu:repair should
  internally handle pushing its own admin fix commits, either via LUMENFLOW_FORCE env var or a
  commit signature the hook recognizes.'
acceptance:
  - wu:repair successfully pushes its fix commits without manual intervention
  - Pre-push hook recognizes and allows wu:repair commits (via env var or commit signature)
  - Existing pre-push protections remain intact for non-repair pushes
claimed_mode: worktree
worktree_path: /home/tom/source/hellmai/os/worktrees/operations-infrastructure-wu-1418
claimed_at: 2026-02-04T15:42:59.560Z
baseline_main_sha: 2d5b1c409075acacb5877a8d6c69ea30cf552bbb
session_id: 2c62c29c-8504-49e6-9ced-164a1283bda5
approved_by:
  - tom@hellm.ai
approved_at: 2026-02-04T15:42:59.566Z
locked: true
completed_at: 2026-02-04T15:51:03.624Z
