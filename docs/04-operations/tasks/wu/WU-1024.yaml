id: WU-1024
title: Pre-push hook should allow CLI tool pushes to main
lane: 'Operations: Infrastructure'
type: feature
status: done
priority: P1
created: 2026-01-19
code_paths:
  - .husky/hooks/pre-push.mjs
tests:
  manual:
    - Manual git push to main still blocked
  unit: []
  e2e: []
artifacts:
  - .lumenflow/stamps/WU-1024.done
dependencies: []
spec_refs:
  - internal
risks: []
notes: Bug from WU-1017. CLI tools use micro-worktrees that merge to main - they need to push.
requires_review: false
assigned_to: tom@hellm.ai
escalation_triggers: []
requires_human_escalation: false
requires_cso_approval: false
requires_cto_approval: false
requires_design_approval: false
description: WU-1017 pre-push hook blocks ALL pushes to main, including CLI tools (wu:create,
  wu:edit, wu:done) which legitimately need to push via micro-worktrees. The hook should detect
  CLI-initiated operations and allow them.
acceptance:
  - pre-push allows pushes from tmp/wu-* branches (CLI micro-worktrees)
  - pre-push still blocks manual git push to main
  - wu:create, wu:edit work without LUMENFLOW_FORCE
claimed_mode: worktree
worktree_path: worktrees/operations-infrastructure-wu-1024
claimed_at: 2026-01-19T12:30:21.050Z
baseline_main_sha: b8c395b87aafbf8977a84c47f033a1fb6bc59401
session_id: 4984c6db-7ac0-4ef0-895a-fd00e3581cda
approved_by:
  - tom@hellm.ai
approved_at: 2026-01-19T12:30:21.058Z
locked: true
completed_at: 2026-01-19T12:33:46.523Z
