id: WU-1235
title: Add mem:index command for project convention indexing
lane: 'Framework: Memory'
type: feature
status: ready
priority: P2
created: 2026-01-30
code_paths:
  - packages/@lumenflow/memory/src/mem-index-core.ts
  - packages/@lumenflow/cli/src/mem-index.ts
tests:
  manual: []
  unit:
    - packages/@lumenflow/memory/src/__tests__/mem-index-core.test.ts
    - packages/@lumenflow/cli/__tests__/mem-index.test.ts
  e2e: []
artifacts:
  - .lumenflow/stamps/WU-1235.done
dependencies: []
risks: []
notes: ''
requires_review: false
assigned_to: tom@hellm.ai
exposure: backend-only
escalation_triggers: []
requires_human_escalation: false
requires_cso_approval: false
requires_cto_approval: false
requires_design_approval: false
description: 'Context: Supermemory has a command to index the repo architecture, patterns,
  conventions, and key files. LumenFlow already has patterns for scan repo to produce structured
  artifact (see lane:suggest). Problem: New agents have no awareness of project conventions, file
  structure, or established patterns. Each session rediscovers the same information. Solution: Add
  mem:index command that scans predictable sources and produces project-lifecycle summary nodes.
  Sources to scan: README.md (project overview), LUMENFLOW.md + selected docs (workflow
  conventions), package.json workspace structure (monorepo layout), packages/*/README.md (package
  descriptions), .lumenflow.config.yaml (workflow config), .lumenflow/constraints.md (invariants).
  Output memory nodes tagged: index:architecture, index:conventions, index:commands,
  index:invariants. Deterministic, repeatable, diffable. Each node includes provenance metadata
  (source_path, source_hash, indexed_at). Lifecycle: project. Idempotent: re-running updates
  existing nodes.'
acceptance:
  - mem:index scans README.md, LUMENFLOW.md, package.json
  - Scans .lumenflow.config.yaml if present
  - Creates memory nodes with lifecycle=project and type=summary
  - Nodes tagged with index:architecture, index:conventions, index:commands, index:invariants
  - Provenance metadata includes source_path, source_hash, indexed_at
  - 'Idempotent: re-running does not create duplicates, updates or versions existing'
  - Output shows count of nodes created/updated
  - --dry-run flag shows what would be indexed without writing
  - Unit tests verify source scanning and node creation
  - Documentation updated in memory package README
initiative: INIT-008
