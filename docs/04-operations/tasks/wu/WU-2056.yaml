id: WU-2056
title: Stabilize consumer integration module-resolution gate
lane: 'Framework: Core Validation'
type: bug
status: done
priority: P1
created: 2026-02-23
code_paths:
  - packages/@lumenflow/core/__tests__/consumer-integration.test.ts
tests:
  manual:
    - Run pnpm --filter @lumenflow/core exec vitest run __tests__/consumer-integration.test.ts and
      verify validate/gates checks pass without module-resolution errors
  unit:
    - packages/@lumenflow/core/__tests__/consumer-integration.test.ts
  e2e: []
artifacts:
  - .lumenflow/stamps/WU-2056.done
dependencies: []
risks: []
notes: (auto) Add implementation notes, rollout context, or a short summary of the plan/conversation.
requires_review: false
assigned_to: tom@hellm.ai
exposure: backend-only
escalation_triggers: []
requires_human_escalation: false
requires_cso_approval: false
requires_cto_approval: false
requires_design_approval: false
description: 'Context: @lumenflow/core consumer-integration tests currently install @lumenflow
  packages directly from npm registry, so unrelated registry drift breaks repo-wide gates on main.
  Problem: test failures block unrelated WUs with ERR_MODULE_NOT_FOUND for validate/gates even when
  local source is healthy. Solution: make consumer integration tests deterministic against local
  packaged artifacts and keep assertions focused on real distribution path resolution guarantees.'
acceptance:
  - consumer-integration test suite passes on main without depending on external npm registry state
  - validate and gates command checks in the consumer fixture do not surface Cannot find module
    errors when using local packaged artifacts
claimed_mode: worktree
worktree_path: /home/USER/source/hellmai/os/worktrees/framework-core-validation-wu-2056
claimed_at: 2026-02-23T09:35:27.631Z
baseline_main_sha: a78e9ca265b0085a349e314ec2f5fad83900ea7b
session_id: c5cc1ad1-a82d-4ab9-ac3a-0b9832f00f1e
approved_by:
  - tom@hellm.ai
approved_at: 2026-02-23T09:35:27.638Z
locked: true
completed_at: 2026-02-23T09:56:03.816Z
completed: 2026-02-23
