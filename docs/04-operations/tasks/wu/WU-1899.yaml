id: WU-1899
title: Add signal-based work classifier for code-path-aware UI/backend/docs detection
lane: 'Framework: Core Lifecycle'
type: feature
status: done
priority: P1
created: 2026-02-19
code_paths:
  - packages/@lumenflow/core/src/work-classifier.ts
  - packages/@lumenflow/core/src/__tests__/work-classifier.test.ts
  - packages/@lumenflow/core/src/lumenflow-config-schema.ts
  - docs/04-operations/_frameworks/lumenflow/work-classification.md
  - apps/docs/src/content/docs/reference/work-classifier.mdx
  - packages/@lumenflow/core/src/resolve-policy.ts
  - packages/@lumenflow/core/src/index.ts
tests:
  manual:
    - Verify classifyWork with CSS code_paths returns domain ui regardless of lane name
    - Verify classifyWork with backend-only code_paths returns domain backend
  unit:
    - packages/@lumenflow/core/src/__tests__/work-classifier.test.ts
  e2e: []
artifacts:
  - .lumenflow/stamps/WU-1899.done
dependencies: []
spec_refs:
  - docs/04-operations/_frameworks/lumenflow/wu-sizing-guide.md
risks: []
notes: Use minimatch for code_path pattern matching (already a dependency). Confidence =
  max(matched_signal_weights) not sum. The path-classifiers.ts module already does similar
  signal-based classification for docs-only detection - follow that pattern.
requires_review: false
claimed_mode: worktree
assigned_to: tom@hellm.ai
claimed_at: 2026-02-19T11:56:05.043Z
worktree_path: /home/tom/source/hellmai/os/worktrees/framework-core-lifecycle-wu-1899
session_id: 003574c5-7243-4202-b18c-8c442618b172
exposure: backend-only
escalation_triggers: []
requires_human_escalation: false
approved_by:
  - tom@hellm.ai
approved_at: 2026-02-19T11:56:05.049Z
requires_cso_approval: false
requires_cto_approval: false
requires_design_approval: false
description: 'wu:brief skill suggestions and test methodology are hardcoded to lane parent names
  (laneParent === Experience). This misses UI work in non-Experience lanes. Add a signal-based work
  classifier to @lumenflow/core that determines work domain (ui/backend/docs/infra/mixed) from
  multiple weighted signals: code_paths patterns (weight 1.0), lane hints (0.6), type (0.3),
  description keywords (0.2). Returns abstract capability tags (not client skill names) for
  vendor-agnostic design. Configurable via methodology.work_classification in .lumenflow.config.yaml
  with sensible built-in defaults.'
acceptance:
  - classifyWork(doc, config) returns domain, confidence, signals, capabilities, testMethodologyHint
  - 'Built-in default UI patterns work without config: CSS/SCSS/LESS, components/pages directories,
    app page/layout files, module CSS, styled components'
  - Config schema extended with optional methodology.work_classification.ui.code_path_patterns and
    lane_hints that extend defaults
  - 'Confidence threshold: domain only assigned when combined signal weight >= 0.3'
  - Returns capabilities array (ui-design-awareness, component-reuse-check) NOT client skill names
  - Returns testMethodologyHint smoke-test when domain is ui with confidence >= 0.5
  - 'Unit tests cover: pure code_paths detection, pure lane detection, mixed signals, no-match
    fallback, config overrides, confidence boundaries'
  - Internal docs in docs/04-operations describing work classification signals and configuration
  - Starlight reference docs for work classifier API and configuration
locked: true
completed_at: 2026-02-19T12:13:28.242Z
completed: 2026-02-19
