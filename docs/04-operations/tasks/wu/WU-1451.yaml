id: WU-1451
title: Fix astro-d2 configuration for D2 diagram rendering
lane: 'Operations: Infrastructure'
type: bug
status: in_progress
priority: P1
created: 2026-02-05
code_paths:
  - apps/docs/astro.config.mjs
tests:
  manual:
    - Deploy to Vercel and verify D2 diagrams render on /concepts/visual-overview
  unit: []
  e2e: []
artifacts:
  - .lumenflow/stamps/WU-1451.done
dependencies: []
risks: []
notes: 'Fix: Move astroD2 from markdown.remarkPlugins to integrations array. astro-d2 is an Astro
  integration that requires being called as a function, not passed as a reference. See
  https://astro-d2.vercel.app/getting-started/'
requires_review: false
claimed_mode: worktree
assigned_to: tom@hellm.ai
claimed_at: 2026-02-05T17:57:03.417Z
worktree_path: /home/tom/source/hellmai/os/worktrees/operations-infrastructure-wu-1451
session_id: 92b16a64-2ebb-494d-82ee-82407b0b51a0
exposure: documentation
escalation_triggers: []
requires_human_escalation: false
approved_by:
  - tom@hellm.ai
approved_at: 2026-02-05T17:57:03.423Z
requires_cso_approval: false
requires_cto_approval: false
requires_design_approval: false
description: astro-d2 was configured as remarkPlugin instead of integration. D2 code blocks fell
  through to Shiki for syntax highlighting instead of being rendered as SVG diagrams.
acceptance:
  - D2 diagrams render as SVGs on lumenflow.dev Visual Overview page
