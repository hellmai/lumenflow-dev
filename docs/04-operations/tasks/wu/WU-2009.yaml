id: WU-2009
title: Add claim-validation gate for absolute acceptance criteria drift
lane: 'Framework: Core Validation'
type: feature
status: done
priority: P2
created: 2026-02-22
code_paths:
  - packages/@lumenflow/core/src/validators
  - packages/@lumenflow/core/src/wu-cli-constants.ts
  - packages/@lumenflow/core/package.json
  - packages/@lumenflow/cli/src/gate-defaults.ts
  - packages/@lumenflow/cli/src/gates-runners.ts
  - packages/@lumenflow/cli/src/gates.ts
  - packages/@lumenflow/cli/src/__tests__/gate-registry-defaults.test.ts
  - packages/@lumenflow/cli/src/__tests__/gates-config.test.ts
  - packages/@lumenflow/cli/src/__tests__/gates-plan-resolvers.test.ts
  - docs/04-operations/tasks/wu
tests:
  manual:
    - Add a deliberate absolute-claim mismatch fixture and run the claim-validation gate; verify it
      fails with file and line evidence.
    - Remove or allowlist the fixture and rerun gates; verify claim-validation passes.
  unit:
    - packages/@lumenflow/core/src/__tests__/validators/claim-validation.test.ts
    - packages/@lumenflow/cli/src/__tests__/gate-registry-defaults.test.ts
    - packages/@lumenflow/cli/src/__tests__/gates-config.test.ts
    - packages/@lumenflow/cli/src/__tests__/gates-plan-resolvers.test.ts
  e2e: []
artifacts:
  - .lumenflow/stamps/WU-2009.done
dependencies: []
initiative: INIT-033
phase: 5
spec_refs:
  - docs/04-operations/_frameworks/lumenflow/wu-sizing-guide.md
risks: []
notes: (auto) Add implementation notes, rollout context, or a short summary of the plan/conversation.
requires_review: false
assigned_to: tom@hellm.ai
exposure: backend-only
escalation_triggers: []
requires_human_escalation: false
requires_cso_approval: false
requires_cto_approval: false
requires_design_approval: false
description: 'Context: absolute acceptance claims (e.g., no runtime dependency, all commands use
  runCLI(main), no process.exit in core) drifted from live code without closure blockers. Problem:
  WUs can close with strong language while contradictory patterns still exist. Solution: add a gate
  that parses WU/initiative acceptance text for absolute claim patterns and runs targeted source
  scans; fail gate when contradictions are detected, with actionable mismatch output.'
acceptance:
  - New gate identifies absolute acceptance criteria in WU/initiative specs and evaluates mapped
    code predicates.
  - Gate fails when claims conflict with live code (including legacy config dependency, missing
    runCLI wrappers, and direct core process.exit usage).
  - Gate integrates with pnpm gates and outputs file/line evidence plus remediation hints.
  - Tests cover true positives, true negatives, and allowlist/override behavior for documented
    exceptions.
claimed_mode: worktree
worktree_path: /home/tom/source/hellmai/os/worktrees/framework-core-validation-wu-2009
claimed_at: 2026-02-22T22:52:22.062Z
baseline_main_sha: a98f26d1f1c02cd434530da00b9d0f30ecc5c4c8
session_id: c446f0d0-6bcf-4cb6-b310-fbbfb624eb44
approved_by:
  - tom@hellm.ai
approved_at: 2026-02-22T22:52:22.069Z
locked: true
completed_at: 2026-02-22T23:24:37.496Z
completed: 2026-02-22
