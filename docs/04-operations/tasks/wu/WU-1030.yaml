id: WU-1030
title: Fix wu:create/wu:edit pre-push block leaving main ahead
lane: 'Operations: Infrastructure'
type: feature
status: done
priority: P2
created: 2026-01-19
code_paths:
  - .husky/prepare-commit-msg
  - .husky/commit-msg
  - .husky/hooks/pre-push.mjs
  - .lumenflow/constraints.md
  - .lumenflow/rules/tdd-workflow.md
  - .lumenflow/rules/wu-workflow.md
  - LUMENFLOW.md
  - ai/onboarding/agent-safety-card.md
  - ai/onboarding/first-wu-mistakes.md
  - ai/onboarding/quick-ref-commands.md
  - ai/onboarding/troubleshooting-wu-done.md
  - packages/@lumenflow/cli/src/wu-create.ts
  - packages/@lumenflow/cli/src/wu-done.ts
  - packages/@lumenflow/cli/src/wu-edit.ts
  - packages/@lumenflow/cli/__tests__/init.test.ts
  - packages/@lumenflow/cli/__tests__/pre-push-hook.test.ts
tests:
  manual:
    - 'Manual: run pnpm wu:create and pnpm wu:edit without LUMENFLOW_FORCE'
  unit:
    - packages/@lumenflow/cli/__tests__/pre-push-hook.test.ts
  e2e: []
artifacts:
  - .lumenflow/stamps/WU-1030.done
dependencies: []
spec_refs:
  - internal
risks: []
notes: Completed per acceptance criteria.
requires_review: false
assigned_to: tom@hellm.ai
escalation_triggers: []
requires_human_escalation: false
requires_cso_approval: false
requires_cto_approval: false
requires_design_approval: false
description: >-
  Context: wu:create and wu:edit use micro-worktrees and push spec changes back to origin/main.

  Problem: the pre-push hook blocks direct pushes to main (and emits husky deprecation errors),
  leaving main ahead of origin and preventing further wu:edit runs.

  Solution: remove deprecated husky bootstrap lines and adjust the pre-push policy to allow
  wu:create/wu:edit to push successfully without LUMENFLOW_FORCE.
acceptance:
  - pnpm wu:create and pnpm wu:edit complete without LUMENFLOW_FORCE and without husky deprecation
    errors.
  - Pre-push policy allows micro-worktree pushes for wu:create/wu:edit so main is not left ahead of
    origin.
  - All husky hooks remove deprecated bootstrap lines while preserving their behavior.
  - pnpm format, lint, typecheck -> PASS
claimed_mode: worktree
worktree_path: worktrees/operations-infrastructure-wu-1030
claimed_at: 2026-01-19T21:16:19.350Z
baseline_main_sha: 80cb79065fb7d6cb3eed15bf09e6c3ef98344b5c
session_id: 38dbc6c3-6b3e-443c-b73f-fb9e627e3a4e
approved_by:
  - tom@hellm.ai
approved_at: 2026-01-19T21:16:19.358Z
locked: true
completed_at: 2026-01-19T21:29:27.007Z
