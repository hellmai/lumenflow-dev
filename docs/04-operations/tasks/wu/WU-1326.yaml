id: WU-1326
title: Update orchestrator wave building for lock_policy
lane: 'Framework: Initiatives'
type: feature
status: done
priority: P2
created: 2026-02-02
code_paths:
  - packages/@lumenflow/initiatives/src/initiative-orchestrator.ts
tests:
  manual:
    - pnpm vitest run packages/@lumenflow/initiatives/__tests__/initiative-orchestrator.test.ts -
      all 51 tests pass
    - buildExecutionPlanWithLockPolicy allows multiple WUs per lane when policy=none
    - buildExecutionPlanWithLockPolicy allows ready WU when blocked WU exists with policy=active
    - getLaneAvailability returns correct policy-based availability
  unit:
    - packages/@lumenflow/initiatives/__tests__/initiative-orchestrator.test.ts
  e2e: []
artifacts:
  - .lumenflow/stamps/WU-1326.done
dependencies: []
spec_refs:
  - internal
risks: []
notes:
  - Implementation adds buildExecutionPlanWithLockPolicy(), getLaneAvailability(), and
    getLockPolicyForLane() functions
  - Tests added for all acceptance criteria (12 new tests)
  - Pre-existing lint errors in test file (sonarjs/no-duplicate-string) - test data uses repeated
    patterns
  - Extracted DEFAULT_DEFERRED_REASON constant to fix duplicate string in implementation
requires_review: false
assigned_to: tom@hellm.ai
exposure: backend-only
escalation_triggers: []
requires_human_escalation: false
requires_cso_approval: false
requires_cto_approval: false
requires_design_approval: false
description: Update initiative orchestrator to respect lock_policy when building waves. Blocked WUs
  don't block lane when policy=active. Depends on WU-1323 and WU-1324.
acceptance:
  - Wave building respects lock_policy per lane
  - Blocked WUs do not block lane when policy=active
  - orchestrate:init-status shows policy-aware availability
  - Backward compatible (policy=all is default)
initiative: INIT-013
claimed_mode: worktree
worktree_path: /home/tom/source/hellmai/os/worktrees/framework-initiatives-wu-1326
claimed_at: 2026-02-02T12:23:47.297Z
baseline_main_sha: fb7d2867ef8befbfe41f9d120d60bbc2d961f9c0
session_id: ee6f4e8a-ffee-416b-9702-a087d9c96dbf
approved_by:
  - tom@hellm.ai
approved_at: 2026-02-02T12:23:47.303Z
locked: true
completed_at: 2026-02-02T12:45:41.785Z
