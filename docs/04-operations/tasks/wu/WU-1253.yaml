id: WU-1253
title: Extract hardcoded prompt templates to .lumenflow/templates/
lane: 'Framework: Core'
type: feature
status: done
priority: P1
created: 2026-01-30
code_paths:
  - packages/@lumenflow/core/src/wu-spawn.ts
  - packages/@lumenflow/core/src/template-loader.ts
  - packages/@lumenflow/core/src/index.ts
  - .lumenflow/templates/manifest.yaml
  - .lumenflow/templates/spawn-prompt/
tests:
  manual:
    - Verify acceptance criteria met
  unit:
    - packages/@lumenflow/core/src/__tests__/template-loader.test.ts
  e2e: []
artifacts:
  - .lumenflow/stamps/WU-1253.done
dependencies: []
spec_refs:
  - ~/.lumenflow/plans/methodology-templates.md
risks:
  - Large refactor touching wu-spawn.ts (1642 lines)
notes: |
  Foundation for INIT-009 (Methodology Configurability).
  Reference plan: ~/.claude/plans/linear-moseying-comet.md

  NOT in scope (deferred to INIT-009):
  - methodology.* config schema
  - resolvePolicy() function
  - Methodology-specific templates (tdd-directive.md, test-after-directive.md)
  - Gates integration with methodology
requires_review: false
assigned_to: tom@hellm.ai
exposure: backend-only
escalation_triggers: []
requires_human_escalation: false
requires_cso_approval: false
requires_cto_approval: false
requires_design_approval: false
description: |
  Context: wu-spawn.ts and init.ts have ~3000 lines of hardcoded markdown templates
  as string literals. This makes content hard to maintain, review, and customize.

  Problem: Templates mixed with code, no project-level overrides, massive files.

  Solution: Extract templates to .lumenflow/templates/ with manifest.yaml for
  assembly order. Design for extensibility so INIT-009 (Methodology Configurability)
  can add methodology-specific templates later.

  Template format: Markdown with YAML frontmatter (same as SKILL.md files).
acceptance:
  - Template file structure created (.lumenflow/templates/spawn-prompt/)
  - manifest.yaml defines section order and required/optional flags
  - wu:spawn reads templates from files instead of hardcoded strings
  - Client-specific overrides supported (.lumenflow/templates.claude/ etc)
  - Extensible design supports conditional template inclusion
  - Existing wu:spawn output unchanged (behavioral parity)
  - Unit tests cover template loading and assembly
claimed_mode: worktree
worktree_path: /home/tom/source/hellmai/os/worktrees/framework-core-wu-1253
claimed_at: 2026-01-30T14:26:32.346Z
baseline_main_sha: 2ad1b18a59288e24d66d9ad642c20caa3ef64966
session_id: fcbd5656-a01f-4ee8-97d2-9c5f0b2b3026
approved_by:
  - tom@hellm.ai
approved_at: 2026-01-30T14:26:32.349Z
locked: true
completed_at: 2026-01-30T17:42:01.810Z
