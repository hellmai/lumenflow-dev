id: WU-1415
title: Fix gates infrastructure bugs (vitest --include, docs-only turbo filter)
lane: 'Framework: CLI'
type: bug
status: ready
priority: P1
created: 2026-02-04
code_paths:
  - packages/@lumenflow/cli/src/gates.ts
tests:
  manual:
    - Run pnpm gates on high-risk WU to verify integration tests work
    - Run pnpm gates --docs-only on documentation WU to verify docs-only mode works
  unit:
    - packages/@lumenflow/cli/src/__tests__/gates-integration-tests.test.ts
  e2e: []
artifacts:
  - .lumenflow/stamps/WU-1415.done
dependencies: []
notes: Quick fix for gates infrastructure bugs blocking WU-1414 completion
requires_review: false
assigned_to: tom@hellm.ai
exposure: backend-only
escalation_triggers: []
requires_human_escalation: false
requires_cso_approval: false
requires_cto_approval: false
requires_design_approval: false
description: 'Context: gates.ts integration test and docs-only modes. Problem: (1) vitest run --include is not a valid vitest CLI option, causing CACError. (2) docs-only mode uses directory names as turbo package filters which fail. Solution: (1) Remove --include flags and pass glob patterns as positional arguments. (2) Fix docs-only turbo filter logic to use actual package names or skip tests for pure docs changes.'
acceptance:
  - Integration tests run without CACError when pnpm gates runs on high-risk WU
  - docs-only mode does not fail with turbo package filter error
