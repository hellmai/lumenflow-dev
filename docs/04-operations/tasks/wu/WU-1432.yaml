id: WU-1432
title: MCP schema autogen from CLI options
lane: 'Framework: CLI'
type: feature
status: ready
priority: P2
created: 2026-02-04
code_paths:
  - packages/@lumenflow/core/src/arg-parser.ts
  - packages/@lumenflow/mcp/src/tools.ts
  - packages/@lumenflow/cli/src/wu-create.ts
  - packages/@lumenflow/cli/src/wu-claim.ts
  - packages/@lumenflow/cli/src/wu-status.ts
  - packages/@lumenflow/cli/src/wu-done.ts
  - packages/@lumenflow/cli/src/gates.ts
tests:
  manual: []
  unit:
    - packages/@lumenflow/core/src/__tests__/arg-parser.test.ts
    - packages/@lumenflow/mcp/src/__tests__/tools.test.ts
  e2e: []
artifacts:
  - .lumenflow/stamps/WU-1432.done
dependencies: []
initiative: INIT-MCP-FULL
phase: 1
spec_refs:
  - lumenflow://plans/partitioned-foraging-ocean.md
risks: []
notes: ''
requires_review: false
assigned_to: tom@hellm.ai
exposure: backend-only
escalation_triggers: []
requires_human_escalation: false
requires_cso_approval: false
requires_cto_approval: false
requires_design_approval: false
description: 'Context: MCP tool schemas are manually duplicated from CLI option definitions.
  Problem: schema drift whenever CLI flags change. Solution: centralize CLI command specs in core,
  generate MCP input schemas/CLI args from them, and update MCP tools to use the shared specs.'
acceptance:
  - Shared CLI command specs exported from @lumenflow/core for wu:create, wu:claim, wu:status,
    wu:done, and gates
  - MCP tools derive inputSchema and CLI arg mapping from shared specs (no manual per-tool schemas
    for those commands)
  - Alias flags (e.g., code-path/manual-test) are not exposed in MCP schemas but still work in CLI
  - Unit tests cover schema generation and CLI arg mapping
claimed_mode: worktree
approved_by:
  - tom@hellm.ai
approved_at: 2026-02-04T19:00:02.675Z
