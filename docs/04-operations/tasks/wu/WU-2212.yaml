id: WU-2212
title: Break-glass WU finalization tool (no dist dependency)
lane: 'Operations: Tooling'
type: feature
status: done
priority: P2
created: 2026-02-26
code_paths:
  - scripts/wu-stamp.mjs
  - scripts/__tests__/wu-stamp.test.ts
  - vitest.config.ts
tests:
  manual:
    - Run with dist/ directories removed, verify stamp and event created
    - Run twice, verify idempotent
  unit:
    - scripts/__tests__/wu-stamp.test.ts
  e2e: []
artifacts:
  - .lumenflow/stamps/WU-2212.done
dependencies: []
spec_refs:
  - memory/distributed-state-audit.md
risks: []
notes: >-
  (auto) Add implementation notes, rollout context, or a short summary of the plan/conversation.


  tdd-exception: standalone break-glass script using only Node built-ins, no project imports
  available for unit testing. Manual test plan defined in WU spec.
requires_review: false
claimed_mode: worktree
assigned_to: tom@hellm.ai
claimed_at: 2026-02-26T14:04:33.867Z
worktree_path: /home/USER/source/hellmai/os/worktrees/operations-tooling-wu-2212
session_id: e4013ae0-f26b-45b2-9d01-e4f287e11263
exposure: backend-only
sizing_estimate:
  estimated_files: 3
  estimated_tool_calls: 30
  strategy: single-session
escalation_triggers: []
requires_human_escalation: false
approved_by:
  - tom@hellm.ai
approved_at: 2026-02-26T14:04:33.871Z
requires_cso_approval: false
requires_cto_approval: false
requires_design_approval: false
description: Provide standalone recovery tool for bootstrap failures when CLI dist is broken. Prefer
  wu-stamp.mjs (Node built-ins only, no project build dependency) over raw bash. Tool creates stamp,
  appends schema-safe event to wu-events.jsonl, commits via micro-worktree pattern. Clear
  break-glass-only warnings. Idempotent and auditable.
acceptance:
  - scripts/wu-stamp.mjs runs without packages/*/dist
  - Creates valid .lumenflow/stamps/WU-XXX.done file
  - Appends valid completion event to wu-events.jsonl
  - Commits atomically via micro-worktree pattern
  - Idempotent on re-run (no duplicate stamps or events)
  - Prints break-glass warning on execution
locked: true
completed_at: 2026-02-26T14:18:52.332Z
completed: 2026-02-26
