id: WU-1504
title: Add wu:validate lint for CLI command registration parity
lane: 'Framework: CLI Enforcement'
type: feature
status: done
priority: P2
created: 2026-02-07
code_paths:
  - packages/@lumenflow/core/src/wu-lint.ts
tests:
  manual:
    - Run wu:validate on crafted WU fixture with missing registrations and confirm warning text
  unit:
    - packages/@lumenflow/core/src/__tests__/wu-lint-parity.test.ts
    - packages/@lumenflow/cli/src/__tests__/wu-validate.test.ts
  e2e: []
artifacts:
  - .lumenflow/stamps/WU-1504.done
dependencies:
  - WU-1502
  - WU-1503
initiative: INIT-017
phase: 3
spec_refs:
  - packages/@lumenflow/core/src/wu-lint.ts
risks: []
notes: >-
  Implements structural prevention for the mem:recover-style parity miss.


  Clarifies detection signal and integration point; parity files are validation inputs, not mutation
  targets.
requires_review: false
assigned_to: tom@hellm.ai
exposure: backend-only
escalation_triggers: []
requires_human_escalation: false
requires_cso_approval: false
requires_cto_approval: false
requires_design_approval: false
description: 'Context: command implementations can land without being registered in public-manifest
  and MCP tool mapping, causing silent partial integrations. Problem: code_paths and spec linting do
  not currently catch this class of omissions. Solution: extend WU lint/validate checks to warn when
  WU changes imply a new CLI command but registration surfaces are missing from scope.'
acceptance:
  - 'Define concrete parity heuristic: when WU code_paths include new/changed CLI command
    implementation or package.json bin entry, registration surfaces must be present'
  - Validator checks public-manifest and MCP tools parity as read-only signals and emits actionable
    guidance
  - Parity lint participates in normal wu:prep/gates path via wu:validate strict flow, not
    ad-hoc-only invocation
  - Strict mode treats parity warning as blocking; non-strict remains advisory
claimed_mode: worktree
worktree_path: /home/tom/source/hellmai/os/worktrees/framework-cli-enforcement-wu-1504
claimed_at: 2026-02-07T12:59:47.995Z
baseline_main_sha: 2bc3b7de352fafc694304ade4ba1ecd66af6891f
session_id: 20c5804d-6db9-420e-bf71-1344e7e2c43b
approved_by:
  - tom@hellm.ai
approved_at: 2026-02-07T12:59:48.000Z
locked: true
completed_at: 2026-02-07T13:20:07.773Z
