id: WU-1520
title: Gates graceful degradation for missing optional scripts
lane: 'Framework: CLI Enforcement'
type: feature
status: in_progress
priority: P2
created: 2026-02-07
code_paths:
  - packages/@lumenflow/cli/src/gates.ts
tests:
  manual:
    - Delete format:check script from package.json, run pnpm gates - should warn and skip, not fail
  unit:
    - packages/@lumenflow/cli/src/__tests__/gates-integration-tests.test.ts
  e2e: []
artifacts:
  - .lumenflow/stamps/WU-1520.done
dependencies: []
initiative: INIT-018
phase: 2
spec_refs:
  - docs/04-operations/tasks/initiatives/INIT-018.yaml
risks: []
notes: Defense in depth - even if scaffold adds scripts, gates should degrade gracefully for any
  missing script.
requires_review: false
assigned_to: tom@hellm.ai
exposure: backend-only
escalation_triggers: []
requires_human_escalation: false
requires_cso_approval: false
requires_cto_approval: false
requires_design_approval: false
description: 'Context: gates hard-fail when format:check, spec:linter, lint, or typecheck scripts
  are missing. Problem: new/simple projects that havent configured all tools get ERR_PNPM_NO_SCRIPT
  failures. Solution: if a gate script doesnt exist in package.json, emit warning and skip instead
  of failing. Add --strict flag for CI enforcement.'
acceptance:
  - Missing gate scripts cause a warning and skip, not a hard failure
  - Warning message includes how to add the missing script
  - Invariants check is never skippable
  - --strict flag makes missing scripts a hard failure for CI
  - Gate summary shows which gates were skipped vs passed vs failed
claimed_mode: worktree
worktree_path: /home/USER/source/hellmai/os/worktrees/framework-cli-enforcement-wu-1520
claimed_at: 2026-02-07T13:43:27.454Z
baseline_main_sha: b82aa52805a01cdc7bbad6081aa80050eef08fd7
session_id: a50e673c-0efa-49cb-9b97-96990c8ddcd3
approved_by:
  - tom@hellm.ai
approved_at: 2026-02-07T13:43:27.457Z
