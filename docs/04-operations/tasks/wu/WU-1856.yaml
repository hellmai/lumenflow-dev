id: WU-1856
title: 'Tighten WU-1802 handler code: eliminate over-abstraction and fix bugs'
lane: 'Framework: Core Lifecycle'
type: refactor
status: ready
priority: P1
created: 2026-02-18
code_paths:
  - packages/@lumenflow/mcp/src/runtime-tool-resolver.ts
  - packages/@lumenflow/mcp/src/tools/validation-tools.ts
  - packages/@lumenflow/mcp/src/tools/parity-tools.ts
tests:
  manual:
    - All 63 wu-tools tests pass
    - Typecheck clean
  unit:
    - packages/@lumenflow/mcp/src/__tests__/runtime-tool-resolver.test.ts
  e2e: []
artifacts:
  - .lumenflow/stamps/WU-1856.done
dependencies: []
initiative: INIT-030
phase: 3
risks: []
notes: (auto) Add implementation notes, rollout context, or a short summary of the plan/conversation.
requires_review: false
assigned_to: tom@hellm.ai
exposure: backend-only
escalation_triggers: []
requires_human_escalation: false
requires_cso_approval: false
requires_cto_approval: false
requires_design_approval: false
description: 'Context: WU-1802 validation/lane handlers merged with code quality issues. Problem: PREFIX/SUFFIX constant fragmentation hurts readability, double file read in validateInProcess, laneSuggestInProcess passes empty ProjectContext, pointless CLI flag constants, redundant message constants. Solution: Inline what should be inline, deduplicate, fix the double-read, document the stub.'
acceptance:
  - No PREFIX/SUFFIX fragmented constants — each message is a single constant or inline
  - validateInProcess reads each WU file exactly once
  - LaneFlags and CliFlags removed — standard CLI flags inline
  - No duplicate message values across constant entries
  - laneSuggestInProcess documents its limitations or scans filesystem
