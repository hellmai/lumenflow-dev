id: WU-1561
title: Enforce --help-first rule for CLI commands via hook
lane: 'Operations: Tooling'
type: refactor
status: ready
priority: P1
created: 2026-02-10
code_paths:
  - docs/04-operations/_frameworks/lumenflow/agent/onboarding/starting-prompt.md
  - docs/04-operations/_frameworks/lumenflow/agent/onboarding/quick-ref-commands.md
  - packages/@lumenflow/cli/src/cli-entry-point.ts
tests:
  manual:
    - Run a LumenFlow CLI command without prior --help and verify hook warns or blocks
    - Run --help first, then the command, and verify hook allows it
  unit: []
  e2e: []
artifacts:
  - .lumenflow/stamps/WU-1561.done
dependencies: []
initiative: INIT-021
phase: 5
spec_refs:
  - lumenflow://plans/polished-frolicking-minsky.md
risks: []
notes: (auto) Add implementation notes, rollout context, or a short summary of the plan/conversation.
requires_review: false
assigned_to: tom@hellm.ai
exposure: backend-only
escalation_triggers: []
requires_human_escalation: false
requires_cso_approval: false
requires_cto_approval: false
requires_design_approval: false
description: 'Context: CLAUDE.md rule 1 states agents must run command --help before first use of
  any unfamiliar CLI command. Problem: Agents across all clients (Claude, Codex, Cursor, Gemini)
  routinely skip this, guess flags, and hit avoidable errors. Hooks only work for Claude Code so the
  fix must be in the shared documentation. Solution: Optimize agent onboarding docs,
  quick-ref-commands.md, and CLI error messages to make --help-first unmissable and to surface
  correct usage on failure.'
acceptance:
  - Agent onboarding starting-prompt.md prominently reinforces --help-first before any CLI usage
  - quick-ref-commands.md includes usage examples with exact flags for every command category
  - CLI commands print a hint to run --help when invoked with invalid or missing flags
  - Hook for Claude Code added as optional enforcement layer (not the primary fix)
