id: WU-1429
title: 'wu:create: tighten spec_refs + add notes flag + contextual warnings'
lane: 'Framework: CLI'
type: bug
status: ready
priority: P2
created: 2026-02-04
code_paths:
  - packages/@lumenflow/cli/src/wu-create.ts
  - packages/@lumenflow/cli/src/wu-create-validators.ts
  - packages/@lumenflow/cli/src/arg-parser.ts
tests:
  manual:
    - Run wu:create with empty spec_refs array for feature type and verify error
    - Run wu:create with --initiative that has phases but omit --phase and verify warning
  unit:
    - packages/@lumenflow/cli/src/__tests__/wu-create.test.ts
  e2e: []
artifacts:
  - .lumenflow/stamps/WU-1429.done
dependencies: []
risks: []
notes: Bug fix + enhancement. Small scope, single session. Discovered during INIT-MCP-FULL WU
  creation when empty spec_refs array bypassed validation.
requires_review: false
assigned_to: tom@hellm.ai
exposure: backend-only
escalation_triggers: []
requires_human_escalation: false
requires_cso_approval: false
requires_cto_approval: false
requires_design_approval: false
description: 'Context: wu:create accepts empty spec_refs array for feature WUs, bypassing
  validation. Problem: Agents create incomplete WUs that fail wu:validate later. Also missing
  --notes flag (only wu:edit has it). Solution: Fix empty array check, add --notes flag, emit
  contextual warnings for initiative phase/plan mismatches.'
acceptance:
  - wu:create fails when spec_refs is empty array for feature type
  - wu:create accepts --notes and persists it in WU YAML
  - Warning emitted if --initiative has phases but no --phase provided
  - Warning emitted if initiative has related_plan but no spec_refs
  - Unit tests cover new validations and --notes flag
