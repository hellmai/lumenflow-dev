id: WU-1449
title: Fix flaky orchestrate-initiative-wu1251 test timeout
lane: 'Framework: Initiatives'
type: bug
status: ready
priority: P3
created: 2026-02-05
code_paths:
  - packages/@lumenflow/initiatives/__tests__/orchestrate-initiative-wu1251.test.ts
tests:
  manual:
    - 'Run: pnpm test --filter @lumenflow/initiatives and confirm orchestrate tests pass'
    - 'Run: pnpm gates and confirm no orchestrate-related timeouts'
  unit:
    - packages/@lumenflow/initiatives/__tests__/orchestrate-initiative-wu1251.test.ts
  e2e: []
artifacts:
  - .lumenflow/stamps/WU-1449.done
dependencies: []
risks: []
notes: 'Fix: Replace await import() inside each test with static import at top of file. See Vitest
  best practices.'
requires_review: false
assigned_to: tom@hellm.ai
exposure: backend-only
escalation_triggers: []
requires_human_escalation: false
requires_cso_approval: false
requires_cto_approval: false
requires_design_approval: false
description: 'Context: Test passes on main but times out (5000ms) intermittently in worktree
  environments during wu:done. WU-1437 investigated but misdiagnosed as spec:linter issue. Root
  cause: Test uses dynamic imports (await import) inside each test case rather than static imports
  at module level. This causes module loading overhead per test and resource contention sensitivity
  in worktrees. Solution: Convert to static imports or use beforeAll. Refs:
  vitest.dev/guide/mocking.html, github.com/vitest-dev/vitest/issues/7361'
acceptance:
  - Test uses static imports or beforeAll pattern instead of per-test dynamic imports
  - Test passes consistently in both main and worktree environments
  - No timeout failures during wu:done in worktree (run 5x to verify)
