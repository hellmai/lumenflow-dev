id: WU-2057
title: Document pack execution architecture and fix D2 diagram sizing sitewide
lane: 'Content: Framework Docs'
type: documentation
status: ready
priority: P1
created: 2026-02-23
code_paths:
  - apps/docs/src/content/docs/concepts/tool-execution.mdx
  - apps/docs/src/content/docs/concepts/package-architecture.mdx
  - apps/docs/src/content/docs/concepts/visual-overview.mdx
  - apps/docs/astro.config.mjs
  - apps/docs/src/content/docs/concepts/kernel.mdx
  - apps/docs/src/content/docs/concepts/packs.mdx
tests:
  manual:
    - pnpm --filter @lumenflow/docs build succeeds with all D2 diagrams rendering
    - New pages appear in Architecture sidebar between Packs and Scope Intersection
    - All diagrams render at readable size in content column
  unit: []
  e2e: []
artifacts:
  - .lumenflow/stamps/WU-2057.done
dependencies: []
risks: []
notes: (auto) Add implementation notes, rollout context, or a short summary of the plan/conversation.
requires_review: false
assigned_to: tom@hellm.ai
exposure: documentation
escalation_triggers: []
requires_human_escalation: false
requires_cso_approval: false
requires_cto_approval: false
requires_design_approval: false
description: 'Context: Neither maintainers nor contributors can explain how pack tools execute without reading source code. The runtime-cli-adapter pattern, three-layer execution stack, and two implementation paths are completely undocumented. Additionally, all 9 D2 diagrams in visual-overview.mdx render at unreadable sizes (2500px+ wide SVGs squished into 750px columns). Solution: Create two new Architecture pages (tool-execution.mdx, package-architecture.mdx) with D2 diagrams, rework all existing diagrams for proper sizing, and add cross-references from kernel.mdx and packs.mdx.'
acceptance:
  - tool-execution.mdx covers three-layer stack, complete execution trace, two implementation paths, runtime-cli-adapter deep dive, sandbox boundary, and design rationale
  - package-architecture.mdx covers package dependency graph, reference table, and build/distribution flow
  - 'All 9 existing D2 diagrams in visual-overview.mdx reworked with direction: down or width constraints so text is readable at content-column width'
  - 2 new diagrams added to visual-overview.mdx (tool execution stack + package dependencies)
  - astro.config.mjs sidebar updated with new pages
  - kernel.mdx and packs.mdx have cross-references to tool-execution page
  - Docs build passes with all diagrams rendering correctly
