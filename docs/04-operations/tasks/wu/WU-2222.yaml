id: WU-2222
title: Separate wu:brief evidence from delegation spawning
lane: 'Framework: CLI WU Commands'
type: feature
status: done
priority: P1
created: 2026-02-26
code_paths:
  - packages/@lumenflow/cli/src/wu-brief.ts
  - packages/@lumenflow/cli/src/wu-spawn-prompt-builders.ts
  - packages/@lumenflow/cli/src/wu-spawn-strategy-resolver.ts
  - packages/@lumenflow/cli/src/wu-done-policies.ts
  - packages/@lumenflow/core/src/arg-parser.ts
  - packages/@lumenflow/core/src/schemas/wu-lifecycle-schemas.ts
  - docs/04-operations/_frameworks/lumenflow/agent/onboarding/starting-prompt.md
  - docs/04-operations/_frameworks/lumenflow/agent/onboarding/agent-invocation-guide.md
  - docs/04-operations/_frameworks/lumenflow/agent/onboarding/initiative-orchestration.md
  - docs/04-operations/_frameworks/lumenflow/agent/onboarding/quick-ref-commands.md
  - .claude/skills/orchestration/SKILL.md
  - .claude/skills/multi-agent-coordination/SKILL.md
  - .claude/skills/initiative-management/SKILL.md
  - packages/@lumenflow/cli/templates/core/ai/onboarding/starting-prompt.md.template
  - packages/@lumenflow/cli/templates/core/ai/onboarding/agent-invocation-guide.md.template
  - packages/@lumenflow/cli/templates/core/ai/onboarding/quick-ref-commands.md.template
  - packages/@lumenflow/cli/templates/vendors/claude/.claude/skills/orchestration/SKILL.md.template
  - packages/@lumenflow/cli/templates/vendors/claude/.claude/skills/multi-agent-coordination/SKILL.md.template
  - packages/@lumenflow/cli/templates/vendors/claude/.claude/skills/initiative-management/SKILL.md.template
tests:
  manual:
    - From claimed workspace, run pnpm wu:brief --id <WU-ID> --client codex-cli --evidence-only and
      verify wu-events evidence is written with no spawn prompt output
    - Run pnpm wu:brief --id <WU-ID> --client codex-cli (default mode) and verify prompt output +
      evidence behavior remains intact
    - Trigger missing-evidence path in wu:done and verify remediation text points to evidence-only
      self-implementation flow
  unit:
    - packages/@lumenflow/cli/src/__tests__/wu-done.test.ts
    - packages/@lumenflow/cli/src/__tests__/agent-spawn-coordination.test.ts
    - packages/@lumenflow/core/src/__tests__/arg-parser.test.ts
    - packages/@lumenflow/core/src/__tests__/wu-lifecycle-schemas.test.ts
    - packages/@lumenflow/core/src/schemas/__tests__/cli-flag-verification.test.ts
  e2e: []
artifacts:
  - .lumenflow/stamps/WU-2222.done
dependencies: []
spec_refs:
  - docs/04-operations/tasks/wu/WU-2132.yaml
  - docs/04-operations/tasks/wu/WU-2161.yaml
risks: []
notes: (auto) Add implementation notes, rollout context, or a short summary of the plan/conversation.
requires_review: false
assigned_to: tom@hellm.ai
exposure: backend-only
escalation_triggers: []
requires_human_escalation: false
requires_cso_approval: false
requires_cto_approval: false
requires_design_approval: false
description: 'Context: wu:done currently requires wu:brief evidence for feature/bug WUs, while agent
  docs/skills heavily frame wu:brief as a delegation+spawn precursor. Problem: delegation and
  self-implementation intents are conflated, which causes unnecessary Task spawning and inconsistent
  guidance across code/help/docs/templates. Solution: add an explicit self-implementation evidence
  path (wu:brief --evidence-only), align evidence enforcement with claimed workspace modes
  (including branch-pr), and update orchestration decision trees/docs so delegation and
  self-implementation are first-class distinct paths.'
acceptance:
  - wu:brief supports an explicit evidence-only mode that records auditable evidence without
    emitting spawn prompt content
  - wu:done remediation and policy messaging guide self-implementation flows to evidence-only path
    instead of implying delegation
  - evidence recording/enforcement behavior is consistent for worktree and branch-pr claimed
    workflows
  - orchestration and multi-agent decision trees distinguish delegation (brief/delegate + spawn)
    from self-implementation (brief evidence-only + implement in-session)
  - agent onboarding docs and templates are consistent about wu:brief side effects and the
    self-implementation branch
  - unit tests cover new flags/schemas/parser parity and pass/fail policy paths
claimed_mode: worktree
worktree_path: /home/USER/source/hellmai/lumenflow-dev/worktrees/framework-cli-wu-commands-wu-2222
claimed_at: 2026-02-26T17:35:24.894Z
baseline_main_sha: a3ef96391b719ae03bc39f0455c2676d76e23839
session_id: ab643ebc-c040-4de1-80f3-2700b4540b7d
approved_by:
  - tom@hellm.ai
approved_at: 2026-02-26T17:35:24.900Z
locked: true
completed_at: 2026-02-26T17:48:26.008Z
completed: 2026-02-26
