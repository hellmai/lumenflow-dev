id: WU-2159
title: Block placeholder git identity in commit hooks
lane: 'Framework: CLI Enforcement'
type: bug
status: ready
priority: P1
created: 2026-02-25
code_paths:
  - .husky/hooks/pre-commit.mjs
  - .husky/hooks/__tests__/pre-commit.test.ts
tests:
  manual:
    - Set git user.name=Test User and user.email=test@example.com in a temp repo
    - run .husky/hooks/pre-commit.mjs
    - and verify it exits non-zero with identity-block message.
    - Set git user.name/user.email to valid values in a temp repo
    - run .husky/hooks/pre-commit.mjs
    - and verify it exits zero so existing workflow checks can proceed.
  unit:
    - .husky/hooks/__tests__/pre-commit.test.ts
  e2e: []
artifacts:
  - .lumenflow/stamps/WU-2159.done
dependencies: []
risks: []
notes: 'Hardening follow-up after WU-2155 completion: prevent placeholder git identity leakage (Test
  User/test@example.com) by enforcing a pre-commit guard and tests.'
requires_review: false
assigned_to: tom@hellm.ai
exposure: backend-only
escalation_triggers: []
requires_human_escalation: false
requires_cso_approval: false
requires_cto_approval: false
requires_design_approval: false
description: Prevent placeholder test git identity values from being used in real repository commits
  by enforcing a commit-time guard in pre-commit. The guard must block Test User/test@example.com
  and keep existing workflow behavior intact.
acceptance:
  - pre-commit blocks commits when git user.name is Test User or git user.email is test@example.com
  - pre-commit still allows commits for valid non-placeholder identities and existing lane/main
    workflow checks remain functional
  - hook tests cover both blocked and allowed identity scenarios
