id: WU-1646
title: Extract wu-done.ts into thin orchestrator and helper modules
lane: 'Framework: CLI WU Commands'
type: refactor
status: ready
priority: P1
created: 2026-02-13
code_paths:
  - packages/@lumenflow/cli/src/wu-done.ts
tests:
  manual:
    - Execute representative wu:done success/failure paths and verify unchanged lifecycle outcomes.
  unit:
    - packages/@lumenflow/cli/src/__tests__/wu-done.test.ts
    - packages/@lumenflow/cli/__tests__/wu-done.test.ts
  e2e: []
artifacts:
  - .lumenflow/stamps/WU-1646.done
dependencies: []
initiative: INIT-025
phase: 2
risks: []
notes: INIT-025 Phase 2 WU-B1. Mechanical extraction only, no new abstractions.
requires_review: false
assigned_to: tom@hellm.ai
exposure: backend-only
escalation_triggers: []
requires_human_escalation: false
requires_cso_approval: false
requires_cto_approval: false
requires_design_approval: false
description: Mechanically decompose packages/@lumenflow/cli/src/wu-done.ts into focused helper modules (preflight, gates, ownership, transaction, nudges, audit, staged files, signals) while keeping wu-done.ts as a thin orchestrator.
acceptance:
  - wu-done.ts delegates to extracted helpers and shrinks to orchestration flow without behavior changes.
  - All existing wu:done lifecycle behavior, failure handling, and output semantics remain compatible.
  - Public import/CLI contract for wu:done remains unchanged.
