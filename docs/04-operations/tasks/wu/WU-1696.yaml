id: WU-1696
title: 'Strict debt slice: type-hardening core wu-recovery helpers'
lane: 'Framework: Core Validation'
type: refactor
status: done
priority: P1
created: 2026-02-15
code_paths:
  - packages/@lumenflow/core/src/wu-recovery.ts
  - packages/@lumenflow/core/src/__tests__/wu-recovery.test.ts
tests:
  manual:
    - pnpm --filter @lumenflow/core exec vitest run src/__tests__/wu-recovery.test.ts
    - pnpm --filter @lumenflow/core typecheck
    - pnpm --filter @lumenflow/core exec tsc --noEmit --strictNullChecks true --noImplicitAny true
      --useUnknownInCatchVariables true --pretty false 2>&1 | rg '^src/wu-recovery.ts' and confirm
      no diagnostics
  unit:
    - packages/@lumenflow/core/src/__tests__/wu-recovery.test.ts
  e2e: []
artifacts:
  - .lumenflow/stamps/WU-1696.done
dependencies: []
initiative: INIT-022
phase: 10
spec_refs:
  - docs/04-operations/tasks/initiatives/INIT-022.yaml
risks: []
notes: Initial strict-config flip attempt revealed large package-level debt still hidden by tsconfig
  flag overrides. Scope was narrowed to a high-impact strict hotspot in core/wu-recovery to preserve
  forward progress.
requires_review: false
assigned_to: tom@hellm.ai
exposure: backend-only
escalation_triggers: []
requires_human_escalation: false
requires_cso_approval: false
requires_cto_approval: false
requires_design_approval: false
description: 'Context: strict debt remains concentrated in core helper modules, with
  packages/@lumenflow/core/src/wu-recovery.ts showing repeated TS7006/TS7031 parameter issues and
  TS18046 unknown-catch hazards under strict probes. Problem: implicit-any and unknown handling in
  recovery paths reduce type safety in critical rollback/recovery flows. Solution: add focused unit
  coverage for recovery helpers and type-hardening annotations to eliminate strict diagnostics in
  this file without behavior regressions.'
acceptance:
  - Strict probe with strictNullChecks/noImplicitAny/useUnknownInCatchVariables reports no
    diagnostics for packages/@lumenflow/core/src/wu-recovery.ts
  - packages/@lumenflow/core/src/__tests__/wu-recovery.test.ts passes
  - pnpm --filter @lumenflow/core typecheck passes
claimed_mode: worktree
worktree_path: /home/tom/source/hellmai/os/worktrees/framework-core-validation-wu-1696
claimed_at: 2026-02-15T20:40:19.670Z
baseline_main_sha: c0edf90a462809e5db1416a1e0b70528d28dd363
session_id: 384c1e93-9b87-426d-8d8d-738be02754a9
approved_by:
  - tom@hellm.ai
approved_at: 2026-02-15T20:40:19.678Z
locked: true
completed_at: 2026-02-15T20:48:25.884Z
completed: 2026-02-15
