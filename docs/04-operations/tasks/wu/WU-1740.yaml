id: WU-1740
title: Control Plane SDK — ControlPlaneSyncPort + workspace config + mock adapter
lane: 'Framework: Core Validation'
type: feature
status: ready
priority: P2
created: 2026-02-16
code_paths:
  - packages/@lumenflow/control-plane-sdk/
tests:
  manual:
    - pnpm typecheck passes
  unit:
    - packages/@lumenflow/control-plane-sdk/__tests__/sync-port.test.ts
    - packages/@lumenflow/control-plane-sdk/__tests__/policy-mode.test.ts
  e2e: []
artifacts:
  - .lumenflow/stamps/WU-1740.done
dependencies: []
initiative: INIT-029
phase: 5
blocked_by:
  - WU-1735
labels:
  - control-plane
  - phase-5
  - sdk
spec_refs:
  - .claude/plans/golden-prancing-cookie.md
risks: []
notes: (auto) Add implementation notes, rollout context, or a short summary of the plan/conversation.
requires_review: false
assigned_to: tom@hellm.ai
exposure: api
escalation_triggers: []
requires_human_escalation: false
requires_cso_approval: false
requires_cto_approval: false
requires_design_approval: false
description: 'Context: INIT-029 Phase 5 — Control Plane SDK. Depends on WU-1735 (KernelRuntime). Problem: The hosted control plane needs a well-defined interface for policy sync, telemetry push, evidence export, and identity. Solution: ControlPlaneSyncPort interface with pullPolicies, pullConfig, pushTelemetry, pushEvidence, pushTaskEvents, authenticate, heartbeat methods. Workspace config extension (control_plane section with enabled, endpoint, org_id, sync_interval, policy_mode, local_override). Mock adapter for testing. Policy precedence: authoritative (remote is baseline), tighten-only (local can only add restrictions), dev-override (loosening allowed but logged). Plan: .claude/plans/golden-prancing-cookie.md'
acceptance:
  - 'ControlPlaneSyncPort interface: pullPolicies, pullConfig, pushTelemetry, pushEvidence, pushTaskEvents, authenticate, heartbeat'
  - Workspace config control_plane section with enabled, endpoint, org_id, sync_interval, policy_mode
  - Mock adapter implements ControlPlaneSyncPort for testing
  - tighten-only mode rejects local policy loosening
  - dev-override mode allows loosening but logs it as events
  - SDK compiles and port interface is mockable and testable
  - Telemetry export to mock endpoint works
