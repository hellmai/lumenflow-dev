id: WU-2128
title: 'Standardize error return contracts: ports throw, adapters return Result, CLI catches'
lane: 'Framework: Core Lifecycle'
type: refactor
status: done
priority: P2
created: 2026-02-24
code_paths:
  - packages/@lumenflow/core/src/ports/
  - packages/@lumenflow/core/src/adapters/
  - packages/@lumenflow/core/src/usecases/
tests:
  manual:
    - Run pnpm test --filter=@lumenflow/core and verify updated port/adapter/usecase error contracts
      preserve behavior and CLI catches/formatting.
  unit:
    - packages/@lumenflow/core/src/__tests__/
  e2e: []
artifacts:
  - .lumenflow/stamps/WU-2128.done
dependencies: []
initiative: INIT-037
phase: 4
blocked_by:
  - WU-2116
  - WU-2117
spec_refs:
  - /home/USER/.claude/plans/wild-foraging-taco.md
risks: []
notes: >-
  (auto) Add implementation notes, rollout context, or a short summary of the plan/conversation.


  TDD hardening (takeover): add/update failing unit tests for each contract change before
  implementation.
requires_review: false
assigned_to: tom@hellm.ai
exposure: backend-only
escalation_triggers: []
requires_human_escalation: false
requires_cso_approval: false
requires_cto_approval: false
requires_design_approval: false
description: 'Currently some functions return null on failure, some throw, some return {valid:
  boolean}. No documented or enforced contract. Standardize: ports throw (boundary contracts),
  adapters return Result<T,E> discriminated union, CLI command handlers catch and format for output.
  Document the contract in a brief ADR. Update affected port/adapter/use-case interfaces to match
  the standard.'
acceptance:
  - 'Contract documented: ports throw, adapters return Result<T,E>, CLI catches'
  - Core port interfaces updated to use consistent error contracts
  - Key adapters (SimpleGitLocationAdapter, FileSystemWuStateAdapter) return Result types
  - pnpm test --filter=@lumenflow/core passes
claimed_mode: worktree
worktree_path: /home/USER/source/hellmai/os/worktrees/framework-core-lifecycle-wu-2128
claimed_at: 2026-02-24T22:38:39.968Z
baseline_main_sha: cb2814908e40705d7ccd8bfb9b024a2d1dc8343b
session_id: 497a0c0f-089a-488b-bf3c-f1cd913b9e79
approved_by:
  - tom@hellm.ai
approved_at: 2026-02-24T22:38:39.975Z
locked: true
completed_at: 2026-02-24T22:53:13.548Z
completed: 2026-02-24
