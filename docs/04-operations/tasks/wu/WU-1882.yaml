id: WU-1882
title: Fix segment padding overflow at 10,000+ segments in EvidenceStore
lane: 'Framework: Core Lifecycle'
type: bug
status: ready
priority: P3
created: 2026-02-19
code_paths:
  - packages/@lumenflow/kernel/src/evidence/evidence-store.ts
tests:
  manual:
    - Verify segment 10000+ filenames match pattern and are read correctly
  unit:
    - packages/@lumenflow/kernel/src/__tests__/evidence-store.test.ts
  e2e: []
artifacts:
  - .lumenflow/stamps/WU-1882.done
dependencies: []
initiative: INIT-030
risks: []
notes: 'Sizing: Simple (2 files, ~10 tool calls, <30% context). Two-line production fix + one test case. Found during INIT-030 Phase 5 code review.'
requires_review: false
assigned_to: tom@hellm.ai
exposure: backend-only
escalation_triggers: []
requires_human_escalation: false
requires_cso_approval: false
requires_cto_approval: false
requires_design_approval: false
description: SEGMENT_FILE_PATTERN uses \d{4} (exactly 4 digits) but padStart(4, '0') produces 5+ digit filenames at segment 10000+. These segments become invisible to reads, causing silent data loss. At 10 MiB default threshold this requires ~100 GB of traces â€” unlikely but violates no-latent-bugs principle.
acceptance:
  - SEGMENT_FILE_PATTERN matches variable-width segment numbers (\d+ instead of \d{4})
  - padStart uses 8 digits for future-proofing
  - 'Test: create segment 10000, verify it is readable by a fresh store instance'
