id: WU-1020
title: Fix TypeScript error in metrics-snapshot.ts for readonly array cast
lane: CLI
type: bug
status: done
priority: P2
created: 2026-01-19
code_paths:
  - packages/@lumenflow/cli/src/metrics-snapshot.ts
tests:
  manual:
    - Verify acceptance criteria met
  unit:
    - packages/@lumenflow/cli/src/__tests__/metrics-snapshot.test.ts
  e2e: []
artifacts:
  - .lumenflow/stamps/WU-1020.done
dependencies: []
risks: []
notes: Completed per acceptance criteria.
requires_review: false
assigned_to: tom@hellm.ai
escalation_triggers: []
requires_human_escalation: false
requires_cso_approval: false
requires_cto_approval: false
requires_design_approval: false
description: |
  Fix TypeScript compilation error in metrics-snapshot.ts caused by readonly array cast.

  Context: The simple-git library returns `logResult.all` as a readonly array type
  `readonly (DefaultLogFields & ListLogLine)[]`.

  Problem: Casting directly to `GitLogEntry[]` fails because TypeScript cannot cast
  a readonly array to a mutable array type.

  Solution: Spread the readonly array into a new mutable array before casting:
  `[...logResult.all] as GitLogEntry[]`
acceptance:
  - TypeScript compilation succeeds without errors in metrics-snapshot.ts
  - pnpm typecheck passes for @lumenflow/cli package
  - pnpm format, lint, typecheck passes
claimed_mode: worktree
worktree_path: worktrees/cli-wu-1020
claimed_at: 2026-01-19T12:12:00.229Z
baseline_main_sha: 77326ab384fd56742a0cd2786a5c88520abdc32c
session_id: 4984c6db-7ac0-4ef0-895a-fd00e3581cda
approved_by:
  - tom@hellm.ai
approved_at: 2026-01-19T12:12:00.237Z
locked: true
completed_at: 2026-01-19T12:15:42.870Z
