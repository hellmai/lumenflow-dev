id: WU-1353
title: Sync CLI templates with source docs and add release automation
lane: 'Framework: CLI'
type: feature
status: in_progress
priority: P1
created: 2026-02-02
code_paths:
  - packages/@lumenflow/cli/templates/core/.lumenflow/constraints.md.template
  - packages/@lumenflow/cli/templates/core/ai/onboarding/first-wu-mistakes.md.template
  - packages/@lumenflow/cli/src/sync-templates.ts
  - docs/04-operations/_frameworks/lumenflow/agent/onboarding/release-process.md
tests:
  manual:
    - Run templates:sync and verify templates match source
    - Verify drift detection catches intentional difference
  unit:
    - packages/@lumenflow/cli/src/__tests__/templates-sync.test.ts
  e2e: []
artifacts:
  - .lumenflow/stamps/WU-1353.done
dependencies: []
risks: []
notes: |
  Implementation adds sync-templates.ts CLI script that:
  1. Syncs source docs to CLI templates with {{DATE}} placeholder substitution
  2. Provides --check-drift mode for CI to detect template drift
  3. Supports dry-run mode for testing without file writes
  Run with: pnpm sync:templates or pnpm templates:sync
spec_refs:
  - lumenflow://plans/template-sync-automation
requires_review: false
assigned_to: tom@hellm.ai
exposure: backend-only
escalation_triggers: []
requires_human_escalation: false
requires_cso_approval: false
requires_cto_approval: false
requires_design_approval: false
description: CLI templates (packages/@lumenflow/cli/templates/) are out of sync with source docs.
  constraints.md.template is v1.0 with 6 constraints (source has v1.1 with 7 + 'never quick fix on
  main'). first-wu-mistakes.md.template has 10 mistakes (source has 11 + wu:prep refs). Need to sync
  templates and add automation to prevent future drift.
acceptance:
  - constraints.md.template synced with source (v1.1, 7 constraints, MANDATORY PRE-WRITE CHECK,
    NEVER QUICK FIX ON MAIN)
  - first-wu-mistakes.md.template synced with source (11 mistakes including Quick Fixing on Main,
    wu:prep refs, spec_refs in checklist)
  - templates:sync script added to scripts/ that copies source docs to templates with {{DATE}}
    placeholder
  - release-process.md updated to include templates:sync as pre-publish step
  - CI check added that warns if templates differ from source (drift detection)
claimed_mode: worktree
worktree_path: /home/tom/source/hellmai/os/worktrees/framework-cli-wu-1353
claimed_at: 2026-02-02T16:46:38.638Z
baseline_main_sha: 77d16e906260eaebd459c2679414abfdfc64a9d9
session_id: 5a6b6502-4a07-4f80-b97f-9dc7afe19e34
approved_by:
  - tom@hellm.ai
approved_at: 2026-02-02T16:46:38.645Z
