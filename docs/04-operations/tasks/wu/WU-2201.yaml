id: WU-2201
title: 'Phase 1: Canonicalize sync adapter types under ISyncValidatorGitAdapter'
lane: 'Framework: Core Lifecycle'
type: refactor
status: ready
priority: P2
created: 2026-02-26
code_paths:
  - packages/@lumenflow/core/src/ports
  - packages/@lumenflow/core/src/wu-helpers.ts
  - packages/@lumenflow/core/src/wu-done-main-sync.ts
  - packages/@lumenflow/core/src/wu-done-worktree-services.ts
tests:
  manual:
    - Run targeted core tests for sync helper modules and verify zero runtime behavior changes
  unit:
    - packages/@lumenflow/core/src/__tests__/wu-helpers.test.ts
    - packages/@lumenflow/core/src/__tests__/wu-done-rollback-leaks.test.ts
    - packages/@lumenflow/core/src/__tests__/wu-done-worktree-services.test.ts
  e2e: []
artifacts:
  - .lumenflow/stamps/WU-2201.done
dependencies: []
risks: []
notes: (auto) Add implementation notes, rollout context, or a short summary of the plan/conversation.
requires_review: false
assigned_to: tom@hellm.ai
exposure: backend-only
escalation_triggers: []
requires_human_escalation: false
requires_cso_approval: false
requires_cto_approval: false
requires_design_approval: false
description: 'Context: main-branch sync checks currently use duplicated adapter shapes across helper
  and wu:done modules. Problem: duplicated types drift and obscure the intended contract for sync
  validation. Solution: introduce a canonical sync-validator port interface and migrate existing
  sync adapter declarations to typed aliases derived from that interface with no runtime behavior
  changes.'
acceptance:
  - Add packages/@lumenflow/core/src/ports/sync-validator.ports.ts with canonical
    ISyncValidatorGitAdapter interface
  - Replace duplicated sync adapter type/interface declarations in wu-helpers.ts,
    wu-done-main-sync.ts, and wu-done-worktree-services.ts with canonical aliases/Pick types
  - No functional behavior change in sync checks; this WU is type-contract consolidation only
  - Core tests covering ensureMainUpToDate/validateMainNotBehindOrigin/service validation pass
approved_by:
  - tom@hellm.ai
approved_at: 2026-02-26T12:53:10.987Z
