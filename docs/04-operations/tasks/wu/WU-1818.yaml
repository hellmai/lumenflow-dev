id: WU-1818
title: Create AG-UI event adapter mapping kernel events to AG-UI protocol
lane: 'Framework: MCP'
type: feature
status: ready
priority: P1
created: 2026-02-18
code_paths:
  - packages/@lumenflow/surfaces/http/
tests:
  manual:
    - Stream kernel events through adapter, verify AG-UI event shape
  unit:
    - packages/@lumenflow/surfaces/__tests__/ag-ui-adapter.test.ts
  e2e: []
artifacts:
  - .lumenflow/stamps/WU-1818.done
dependencies: []
initiative: INIT-031
phase: 1
blocked_by:
  - WU-1817
spec_refs:
  - .claude/plans/zazzy-growing-cook.md
risks: []
notes: (auto) Add implementation notes, rollout context, or a short summary of the plan/conversation.
requires_review: false
assigned_to: tom@hellm.ai
exposure: api
escalation_triggers: []
requires_human_escalation: false
requires_cso_approval: false
requires_cto_approval: false
requires_design_approval: false
description: Map KernelEvent discriminated union to AG-UI event types. task_created->RunStarted, run_started->StepStarted, ToolTraceEntry->TOOL_CALL_START/END, PolicyDecision->custom governance event, TaskState projection->StateSnapshot/StateDelta. AG-UI TypeScript SDK as dependency. Separate module in surfaces/http/ag-ui-adapter.ts.
acceptance:
  - All 17 kernel event kinds mapped to AG-UI event types
  - ToolTraceEntry correctly maps to TOOL_CALL_START, TOOL_CALL_END, TOOL_CALL_RESULT
  - PolicyDecision events include governance metadata
  - StateSnapshot emitted on connection, StateDelta on state changes
