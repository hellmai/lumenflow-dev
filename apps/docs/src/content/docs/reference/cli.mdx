---
title: CLI Commands
description: Complete CLI reference for LumenFlow
---

{/* AUTO-GENERATED FILE - DO NOT EDIT DIRECTLY */}
{/* Run `pnpm docs:generate` to regenerate from source */}
{/* Includes formatting stabilization (WU-1157) */}

import { Aside, Tabs, TabItem } from '@astrojs/starlight/components';

LumenFlow provides a curated public CLI surface for everyday workflows.

<Aside type="tip">
This page lists primary commands only. Use `pnpm lumenflow:commands` for full command discovery including aliases and legacy entrypoints.
</Aside>

## Commands Overview

| Category | Commands |
|----------|----------|
| Gates & Quality | [`gates`](#gates), [`lane:edit`](#laneedit), [`lane:health`](#lanehealth), [`lane:lock`](#lanelock), [`lane:setup`](#lanesetup), [`lane:status`](#lanestatus), [`lane:suggest`](#lanesuggest), [`lane:validate`](#lanevalidate), [`validate`](#validate) |
| Initiatives | [`initiative:add-wu`](#initiativeadd-wu), [`initiative:bulk-assign`](#initiativebulk-assign), [`initiative:create`](#initiativecreate), [`initiative:edit`](#initiativeedit), [`initiative:list`](#initiativelist), [`initiative:plan`](#initiativeplan), [`initiative:remove-wu`](#initiativeremove-wu), [`initiative:status`](#initiativestatus) |
| Memory & Sessions | [`mem:checkpoint`](#memcheckpoint), [`mem:cleanup`](#memcleanup), [`mem:context`](#memcontext), [`mem:create`](#memcreate), [`mem:delete`](#memdelete), [`mem:export`](#memexport), [`mem:inbox`](#meminbox), [`mem:init`](#meminit), [`mem:ready`](#memready), [`mem:recover`](#memrecover), [`mem:signal`](#memsignal), [`mem:start`](#memstart), [`mem:summarize`](#memsummarize), [`mem:triage`](#memtriage), [`signal:cleanup`](#signalcleanup) |
| Metrics & Flow | [`flow:bottlenecks`](#flowbottlenecks), [`flow:report`](#flowreport), [`metrics`](#metrics), [`metrics:snapshot`](#metricssnapshot) |
| Orchestration | [`agent:issues-query`](#agentissues-query), [`agent:log-issue`](#agentlog-issue), [`agent:session`](#agentsession), [`agent:session-end`](#agentsession-end), [`delegation:list`](#delegationlist), [`orchestrate:init-status`](#orchestrateinit-status), [`orchestrate:initiative`](#orchestrateinitiative), [`orchestrate:monitor`](#orchestratemonitor), [`task:claim`](#taskclaim) |
| Packs | [`pack:author`](#packauthor), [`pack:hash`](#packhash), [`pack:install`](#packinstall), [`pack:publish`](#packpublish), [`pack:scaffold`](#packscaffold), [`pack:search`](#packsearch), [`pack:validate`](#packvalidate) |
| Plans | [`plan:create`](#plancreate), [`plan:edit`](#planedit), [`plan:link`](#planlink), [`plan:promote`](#planpromote) |
| Setup & Development | [`backlog:prune`](#backlogprune), [`cloud:connect`](#cloudconnect), [`config:get`](#configget), [`config:set`](#configset), [`file:delete`](#filedelete), [`file:edit`](#fileedit), [`file:read`](#fileread), [`file:write`](#filewrite), [`git:branch`](#gitbranch), [`git:diff`](#gitdiff), [`git:log`](#gitlog), [`git:status`](#gitstatus), [`lumenflow`](#lumenflow), [`lumenflow:commands`](#lumenflowcommands), [`lumenflow:docs-sync`](#lumenflowdocs-sync), [`lumenflow:doctor`](#lumenflowdoctor), [`lumenflow:integrate`](#lumenflowintegrate), [`lumenflow:release`](#lumenflowrelease), [`lumenflow:sync-templates`](#lumenflowsync-templates), [`lumenflow:upgrade`](#lumenflowupgrade) |
| State Management | [`state:bootstrap`](#statebootstrap), [`state:cleanup`](#statecleanup), [`state:doctor`](#statedoctor) |
| WU Lifecycle | [`wu:block`](#wublock), [`wu:brief`](#wubrief), [`wu:claim`](#wuclaim), [`wu:create`](#wucreate), [`wu:delegate`](#wudelegate), [`wu:done`](#wudone), [`wu:edit`](#wuedit), [`wu:prep`](#wuprep), [`wu:recover`](#wurecover), [`wu:release`](#wurelease), [`wu:sandbox`](#wusandbox), [`wu:status`](#wustatus), [`wu:unblock`](#wuunblock), [`wu:validate`](#wuvalidate) |
| WU Maintenance | [`wu:cleanup`](#wucleanup), [`wu:delete`](#wudelete), [`wu:deps`](#wudeps), [`wu:infer-lane`](#wuinfer-lane), [`wu:preflight`](#wupreflight), [`wu:proto`](#wuproto), [`wu:prune`](#wuprune), [`wu:repair`](#wurepair), [`wu:unlock-lane`](#wuunlock-lane) |

## Gates & Quality

### gates

Run all quality gates

```bash
pnpm gates
```

### lane:edit

Edit a lane definition (rename, wip-limit, paths, description)

```bash
pnpm lane:edit
```

### lane:health

Check lane config health

```bash
pnpm lane:health
```

### lane:lock

Lock lane lifecycle for delivery WUs

```bash
pnpm lane:lock
```

### lane:setup

Create/update draft lane artifacts

```bash
pnpm lane:setup
```

### lane:status

Show lane lifecycle status and next step

```bash
pnpm lane:status
```

### lane:suggest

Suggest lane for code paths

```bash
pnpm lane:suggest
```

### lane:validate

Validate lane artifacts before lock

```bash
pnpm lane:validate
```

### validate

Run validation checks

```bash
pnpm validate
```

## Initiatives

### initiative:add-wu

Add WU to initiative

```bash
pnpm initiative:add-wu --initiative <ref>
```

**Options:**

| Flag | Description | Required |
|------|-------------|----------|
| `--initiative &lt;ref&gt;` | Parent initiative (INIT-XXX or slug) | Yes |

### initiative:bulk-assign

Bulk assign WUs to initiative

```bash
pnpm initiative:bulk-assign
```

**Options:**

| Flag | Description | Required |
|------|-------------|----------|
| `--config &lt;path&gt;` | Path to config file (tool-specific) | No |
| `--apply` | Apply changes (default is dry-run) | No |
| `--sync-from-initiative` | Ensure WU initiative fields exist for WUs listed in initiatives | No |

### initiative:create

Create new initiative

```bash
pnpm initiative:create --id <wuId> --slug <slug> --title <title>
```

**Options:**

| Flag | Description | Required |
|------|-------------|----------|
| `-i, --id &lt;wuId&gt;` | Work Unit ID (e.g., WU-123). If not provided, auto-generates next sequential ID. | Yes |
| `-s, --slug &lt;slug&gt;` | Initiative slug (kebab-case) | Yes |
| `-t, --title &lt;title&gt;` | Work Unit title | Yes |
| `-p, --priority &lt;priority&gt;` | Priority level (P0, P1, P2, P3) | No |
| `-o, --owner &lt;owner&gt;` | Initiative owner (team or individual) | No |
| `--target-date &lt;date&gt;` | Target completion date (YYYY-MM-DD) | No |

### initiative:edit

Edit initiative fields and phase metadata

```bash
pnpm initiative:edit
```

**Options:**

| Flag | Description | Required |
|------|-------------|----------|
| `-i, --id &lt;initId&gt;` | Initiative ID (e.g., INIT-001) | No |
| `--blocked-by &lt;initId&gt;` | Initiative ID that blocks this initiative | No |
| `--blocked-reason &lt;text&gt;` | Reason for blocking (required with --blocked-by) | No |
| `--unblock` | Remove blocked_by and blocked_reason fields | No |
| `--add-lane &lt;lane&gt;` | Lane to add (repeatable) | No |
| `--remove-lane &lt;lane&gt;` | Lane to remove (repeatable) | No |
| `--notes &lt;text&gt;` | Note to append to notes array | No |
| `--description &lt;text&gt;` | Replace the initiative description field | No |
| `--add-phase &lt;title&gt;` | Append a new phase with auto-incremented id and pending status (repeatable) | No |
| `--add-success-metric &lt;text&gt;` | Append to success_metrics array, avoiding duplicates (repeatable) | No |
| `--remove-success-metric &lt;text&gt;` | Remove exact match from success_metrics array (repeatable) | No |
| `--phase-id &lt;id&gt;` | Phase ID to update (use with --phase-status) | No |
| `--phase-title &lt;title&gt;` | Update phase title (use with --phase-id) | No |
| `--created &lt;date&gt;` | Set created date (YYYY-MM-DD format) | No |

### initiative:list

List all initiatives

```bash
pnpm initiative:list
```

**Options:**

| Flag | Description | Required |
|------|-------------|----------|
| `--format &lt;format&gt;` | Output format (table, json, ascii, mermaid) | No |
| `--status &lt;status&gt;` | Filter by status | No |
| `--color` | Enable colored output | No |

### initiative:plan

Link plan to initiative

```bash
pnpm initiative:plan --initiative <ref>
```

**Options:**

| Flag | Description | Required |
|------|-------------|----------|
| `--initiative &lt;ref&gt;` | Parent initiative (INIT-XXX or slug) | Yes |

### initiative:remove-wu

Remove WU from initiative

```bash
pnpm initiative:remove-wu --initiative <ref> --wu <wuId>
```

**Options:**

| Flag | Description | Required |
|------|-------------|----------|
| `--initiative &lt;ref&gt;` | Parent initiative (INIT-XXX or slug) | Yes |
| `--wu &lt;wuId&gt;` | Work Unit ID to link (e.g., WU-123) | Yes |

### initiative:status

Show initiative status

```bash
pnpm initiative:status
```

**Options:**

| Flag | Description | Required |
|------|-------------|----------|
| `-i, --id &lt;wuId&gt;` | Work Unit ID (e.g., WU-123). If not provided, auto-generates next sequential ID. | No |
| `--format &lt;format&gt;` | Output format (table, json, ascii, mermaid) | No |
| `--color` | Enable colored output | No |

## Memory & Sessions

### mem:checkpoint

Save progress checkpoint

```bash
pnpm mem:checkpoint
```

**Options:**

| Flag | Description | Required |
|------|-------------|----------|
| `--wu &lt;wuId&gt;` | Work Unit ID to link (e.g., WU-123) | No |
| `-n, --note &lt;text&gt;` | Checkpoint note (required if not positional) | No |
| `-s, --session &lt;id&gt;` | Session ID to link checkpoint to (UUID) | No |
| `-p, --progress &lt;text&gt;` | Progress summary | No |
| `--next-steps &lt;text&gt;` | Next steps description | No |
| `-t, --trigger &lt;type&gt;` | Handoff trigger type (e.g., clear, handoff) | No |
| `-d, --base-dir &lt;path&gt;` | Base directory (defaults to current directory) | No |
| `-q, --quiet` | Suppress output except errors | No |

### mem:cleanup

Clean up stale memory data

```bash
pnpm mem:cleanup
```

**Options:**

| Flag | Description | Required |
|------|-------------|----------|
| `--dry-run` | Preview cleanup without making changes | No |
| `--ttl &lt;duration&gt;` | Remove nodes older than duration (e.g., 30d, 7d, 24h). Active sessions are protected. | No |
| `--session-id &lt;uuid&gt;` | Session ID to consider closed (removes session lifecycle nodes) | No |
| `--json` | Output as JSON | No |
| `-q, --quiet` | Suppress output except errors | No |
| `-b, --base-dir &lt;path&gt;` | Base directory (defaults to current directory) | No |
| `--decay` | Run decay-based archival (archive stale nodes below threshold). Uses config from workspace.yaml software_delivery or defaults. | No |

### mem:context

Get context for current lane/WU

```bash
pnpm mem:context --wu <wuId>
```

**Options:**

| Flag | Description | Required |
|------|-------------|----------|
| `--wu &lt;wuId&gt;` | Work Unit ID to link (e.g., WU-123) | Yes |
| `-m, --max-size &lt;bytes&gt;` | Maximum context size in bytes (default: 4096) | No |
| `--delegation-context-max-size &lt;bytes&gt;` | Alias for --max-size (for config parity with delegation_context_max_size) | No |
| `-l, --lane &lt;lane&gt;` | Filter project memories by lane (e.g., &quot;Framework: CLI&quot;) | No |
| `--max-recent-summaries &lt;count&gt;` | Maximum number of recent summaries to include (default: 5) | No |
| `--max-project-nodes &lt;count&gt;` | Maximum number of project nodes to include (default: 10) | No |
| `-f, --format &lt;format&gt;` | Output format: json or human (default: human) | No |
| `-d, --base-dir &lt;path&gt;` | Base directory (defaults to current directory) | No |
| `-q, --quiet` | Suppress header/footer output, only show context block | No |

### mem:create

Create memory node (bug discovery)

```bash
pnpm mem:create
```

**Options:**

| Flag | Description | Required |
|------|-------------|----------|
| `--wu &lt;wuId&gt;` | Work Unit ID to link (e.g., WU-123) | No |
| `-t, --title &lt;text&gt;` | Node title/content (required if not positional) | No |
| `-d, --discovered-from &lt;id&gt;` | Parent node ID for provenance tracking (mem-XXXX format) | No |
| `-s, --session &lt;id&gt;` | Session ID to link node to (UUID) | No |
| `--tags &lt;tags&gt;` | Comma-separated tags for categorization | No |
| `-p, --priority &lt;level&gt;` | Priority level (P0, P1, P2, P3) | No |
| `-b, --base-dir &lt;path&gt;` | Base directory (defaults to current directory) | No |
| `-q, --quiet` | Suppress output except errors | No |

### mem:delete

Delete/archive a memory node

```bash
pnpm mem:delete
```

**Options:**

| Flag | Description | Required |
|------|-------------|----------|
| `--dry-run` | Preview deletion without making changes | No |
| `--tag &lt;tag&gt;` | Delete all nodes matching this tag | No |
| `--older-than &lt;duration&gt;` | Delete nodes older than duration (e.g., 30d, 7d, 24h, 2w) | No |
| `--json` | Output as JSON | No |
| `-q, --quiet` | Suppress output except errors | No |
| `-b, --base-dir &lt;path&gt;` | Base directory (defaults to current directory) | No |

### mem:export

Export memory as markdown

```bash
pnpm mem:export
```

**Options:**

| Flag | Description | Required |
|------|-------------|----------|
| `--wu &lt;wuId&gt;` | Work Unit ID to link (e.g., WU-123) | No |
| `-l, --lifecycle &lt;lifecycle&gt;` | Filter by lifecycle (ephemeral, session, wu, project) | No |
| `-f, --format &lt;format&gt;` | Output format (markdown, json). Default: markdown | No |
| `-d, --base-dir &lt;path&gt;` | Base directory (defaults to current directory) | No |
| `-q, --quiet` | Suppress header/footer output | No |

### mem:inbox

Check coordination signals

```bash
pnpm mem:inbox
```

**Options:**

| Flag | Description | Required |
|------|-------------|----------|
| `--wu &lt;wuId&gt;` | Work Unit ID to link (e.g., WU-123) | No |
| `-l, --lane &lt;lane&gt;` | Lane name (e.g., &quot;Operations: Tooling&quot;) | No |
| `-s, --since &lt;time&gt;` | Filter signals since time (e.g., &quot;1h&quot;, &quot;30m&quot;, &quot;2025-12-09&quot;) | No |
| `-w, --watch` | Continuously monitor for new signals | No |
| `-q, --quiet` | Suppress output except signal content | No |
| `--no-mark` | Do not mark signals as read after display | No |
| `-c, --count` | Output only signal count (lightweight polling for orchestrators) | No |

### mem:init

Initialize memory for WU

```bash
pnpm mem:init
```

**Options:**

| Flag | Description | Required |
|------|-------------|----------|
| `-d, --base-dir &lt;path&gt;` | Base directory to initialize (defaults to current directory) | No |
| `-q, --quiet` | Suppress output except errors | No |

### mem:ready

Check pending memory nodes

```bash
pnpm mem:ready --wu <wuId>
```

**Options:**

| Flag | Description | Required |
|------|-------------|----------|
| `--wu &lt;wuId&gt;` | Work Unit ID to link (e.g., WU-123) | Yes |
| `-f, --format &lt;format&gt;` | Output format (json, human). Default: human | No |
| `-d, --base-dir &lt;path&gt;` | Base directory (defaults to current directory) | No |
| `-q, --quiet` | Suppress header/footer output, only show nodes | No |

### mem:recover

Generate recovery context after compaction

```bash
pnpm mem:recover --wu <wuId>
```

**Options:**

| Flag | Description | Required |
|------|-------------|----------|
| `--wu &lt;wuId&gt;` | Work Unit ID to link (e.g., WU-123) | Yes |
| `-m, --max-size &lt;bytes&gt;` | Maximum output size in bytes (default: 2048) | No |
| `-f, --format &lt;format&gt;` | Output format: json or human (default: human) | No |
| `-d, --base-dir &lt;path&gt;` | Base directory (defaults to current directory) | No |
| `-q, --quiet` | Suppress header/footer output, only show recovery context | No |

### mem:signal

Broadcast coordination signal

```bash
pnpm mem:signal
```

**Options:**

| Flag | Description | Required |
|------|-------------|----------|
| `--wu &lt;wuId&gt;` | Work Unit ID to link (e.g., WU-123) | No |
| `-l, --lane &lt;lane&gt;` | Lane name (e.g., &quot;Operations: Tooling&quot;) | No |
| `-m, --message &lt;text&gt;` | Signal message (required if not positional) | No |
| `-q, --quiet` | Suppress output except errors (outputs signal ID only) | No |

### mem:start

Start a memory session

```bash
pnpm mem:start --wu <wuId>
```

**Options:**

| Flag | Description | Required |
|------|-------------|----------|
| `--wu &lt;wuId&gt;` | Work Unit ID to link (e.g., WU-123) | Yes |
| `-a, --agent-type &lt;type&gt;` | Agent type (e.g., general-purpose, explore, test-engineer) | No |
| `-c, --context-tier &lt;tier&gt;` | Context tier (core, full, minimal) | No |
| `-d, --base-dir &lt;path&gt;` | Base directory (defaults to current directory) | No |
| `-q, --quiet` | Suppress output except errors | No |

### mem:summarize

Summarize memory context

```bash
pnpm mem:summarize --wu <id>
```

**Options:**

| Flag | Description | Required |
|------|-------------|----------|
| `--wu &lt;id&gt;` | WU ID to summarize (e.g., WU-1234) | Yes |
| `--dry-run` | Preview summary without making changes | No |
| `--json` | Output as JSON | No |
| `-q, --quiet` | Suppress output except errors | No |
| `-b, --base-dir &lt;path&gt;` | Base directory (defaults to current directory) | No |

### mem:triage

Triage discovered bugs

```bash
pnpm mem:triage
```

**Options:**

| Flag | Description | Required |
|------|-------------|----------|
| `-l, --list` | List open discoveries (default action) | No |
| `-p, --promote &lt;nodeId&gt;` | Promote discovery to WU (mem-XXXX format) | No |
| `-a, --archive &lt;nodeId&gt;` | Archive discovery without promotion (mem-XXXX format) | No |
| `-r, --reason &lt;text&gt;` | Reason for archiving (required with --archive) | No |
| `--title &lt;text&gt;` | Custom title for promoted WU (optional) | No |
| `--lane &lt;lane&gt;` | Lane for promoted WU (required with --promote) | No |
| `--wu-id &lt;id&gt;` | Explicit WU ID for promotion (optional) | No |
| `--wu &lt;id&gt;` | Filter discoveries by WU ID (or &quot;unlinked&quot;) | No |
| `--tag &lt;tag&gt;` | Filter discoveries by tag | No |
| `--dry-run` | Preview promotion without creating WU | No |
| `--json` | Output as JSON | No |
| `-q, --quiet` | Suppress output except errors | No |

### signal:cleanup

Clean up stale signals

```bash
pnpm signal:cleanup
```

**Options:**

| Flag | Description | Required |
|------|-------------|----------|
| `--dry-run` | Preview cleanup without making changes | No |
| `--ttl &lt;duration&gt;` | TTL for read signals (e.g., 7d, 24h). Default: 7d | No |
| `--unread-ttl &lt;duration&gt;` | TTL for unread signals (e.g., 30d). Default: 30d | No |
| `--max-entries &lt;count&gt;` | Maximum signals to retain. Default: 500 | No |
| `--json` | Output as JSON | No |
| `-q, --quiet` | Suppress output except errors | No |
| `-b, --base-dir &lt;path&gt;` | Base directory (defaults to current directory) | No |

## Metrics & Flow

### flow:bottlenecks

Identify flow bottlenecks

```bash
pnpm flow:bottlenecks
```

### flow:report

Generate flow metrics report

```bash
pnpm flow:report
```

### metrics

View workflow metrics

```bash
pnpm metrics
```

### metrics:snapshot

Capture metrics snapshot

```bash
pnpm metrics:snapshot
```

## Orchestration

### agent:issues-query

Query GitHub issues for agent work

```bash
pnpm agent:issues-query
```

### agent:log-issue

Log issue during agent session

```bash
pnpm agent:log-issue --category <cat> --severity <sev> --title <title> --description <desc>
```

**Options:**

| Flag | Description | Required |
|------|-------------|----------|
| `--category &lt;cat&gt;` | Issue category (workflow\|tooling\|confusion\|violation\|error) | Yes |
| `--severity &lt;sev&gt;` | Severity level (blocker\|major\|minor\|info) | Yes |
| `--title &lt;title&gt;` | Short description (5-100 chars) | Yes |
| `--description &lt;desc&gt;` | Detailed context (10-2000 chars) | Yes |
| `--resolution &lt;res&gt;` | How the issue was resolved | No |
| `--tag &lt;tag&gt;` | Tag for categorization (repeatable) | No |
| `--step &lt;step&gt;` | Current workflow step (e.g., wu:done, gates) | No |
| `--file &lt;file&gt;` | Related file path (repeatable) | No |

### agent:session

Start agent session

```bash
pnpm agent:session --wu <wuId> --tier <tier>
```

**Options:**

| Flag | Description | Required |
|------|-------------|----------|
| `--wu &lt;wuId&gt;` | WU ID to work on (e.g., WU-1234) | Yes |
| `--tier &lt;tier&gt;` | Context tier (1, 2, or 3) | Yes |
| `--agent-type &lt;type&gt;` | Agent type (default: claude-code) | No |

### agent:session-end

End agent session

```bash
pnpm agent:session-end
```

### delegation:list

List active delegation records

```bash
pnpm delegation:list
```

**Options:**

| Flag | Description | Required |
|------|-------------|----------|
| `--wu &lt;wuId&gt;` | Work Unit ID to link (e.g., WU-123) | No |
| `--initiative &lt;initId&gt;` | Initiative ID to show all delegations for (e.g., INIT-001) | No |
| `--json` | Output as JSON | No |

### orchestrate:init-status

Compact initiative progress view

```bash
pnpm orchestrate:init-status
```

### orchestrate:initiative

Orchestrate initiative execution

```bash
pnpm orchestrate:initiative
```

### orchestrate:monitor

Monitor spawn/agent activity

```bash
pnpm orchestrate:monitor
```

### task:claim

Claim a task directly through KernelRuntime

```bash
pnpm task:claim
```

## Packs

### pack:author

Author a secure domain pack from templates

```bash
pnpm pack:author
```

**Options:**

| Flag | Description | Required |
|------|-------------|----------|
| `-f, --force` | Force operation | No |
| `--spec-file &lt;path&gt;` | Path to YAML/JSON request file for non-interactive generation | No |
| `--skip-validate` | Skip post-generation pack validation | No |

### pack:hash

Compute integrity hash for a domain pack

```bash
pnpm pack:hash
```

**Options:**

| Flag | Description | Required |
|------|-------------|----------|
| `-f, --force` | Force operation | No |
| `--pack-root &lt;dir&gt;` | Direct path to pack directory (overrides --id and --packs-root) | No |

### pack:install

Install a domain pack into workspace

```bash
pnpm pack:install --source <source> --version <version>
```

**Options:**

| Flag | Description | Required |
|------|-------------|----------|
| `-f, --force` | Force operation | No |
| `--source &lt;source&gt;` | Pack source: local, git, or registry | Yes |
| `--version &lt;version&gt;` | Pack version in semver format | Yes |
| `--url &lt;url&gt;` | Git repository URL (required for source: git) | No |
| `--registry-url &lt;url&gt;` | Registry base URL (for source: registry) | No |
| `--pack-root &lt;dir&gt;` | Direct path to resolved pack directory on disk (overrides default resolution) | No |
| `--integrity &lt;hash&gt;` | Expected SHA-256 integrity hash in &quot;sha256:&lt;hex&gt;&quot; format (optional) | No |

### pack:publish

Publish a domain pack to a registry

```bash
pnpm pack:publish
```

**Options:**

| Flag | Description | Required |
|------|-------------|----------|
| `-f, --force` | Force operation | No |
| `--pack-root &lt;dir&gt;` | Direct path to pack directory (overrides --id and --packs-root) | No |

### pack:scaffold

Scaffold a new domain pack

```bash
pnpm pack:scaffold --version <version>
```

**Options:**

| Flag | Description | Required |
|------|-------------|----------|
| `-f, --force` | Force operation | No |
| `--version &lt;version&gt;` | Pack version in semver format (e.g., &quot;0.1.0&quot;) | Yes |
| `--task-type &lt;type&gt;` | Task type name (repeatable) | No |
| `--tool &lt;name&gt;` | Tool name to scaffold (repeatable) | No |

### pack:search

Search for domain packs in a registry

```bash
pnpm pack:search
```

**Options:**

| Flag | Description | Required |
|------|-------------|----------|
| `--query &lt;query&gt;` | Search query string | No |

### pack:validate

Validate a domain pack for integrity

```bash
pnpm pack:validate
```

**Options:**

| Flag | Description | Required |
|------|-------------|----------|
| `-f, --force` | Force operation | No |
| `--pack-root &lt;dir&gt;` | Direct path to pack directory (overrides --id and --packs-root) | No |

## Plans

### plan:create

Create a new plan

```bash
pnpm plan:create --id <wuId> --title <title>
```

**Options:**

| Flag | Description | Required |
|------|-------------|----------|
| `-i, --id &lt;wuId&gt;` | Work Unit ID (e.g., WU-123). If not provided, auto-generates next sequential ID. | Yes |
| `-t, --title &lt;title&gt;` | Work Unit title | Yes |

### plan:edit

Edit plan content

```bash
pnpm plan:edit --id <wuId>
```

**Options:**

| Flag | Description | Required |
|------|-------------|----------|
| `-i, --id &lt;wuId&gt;` | Work Unit ID (e.g., WU-123). If not provided, auto-generates next sequential ID. | Yes |

### plan:link

Link plan to WU or initiative

```bash
pnpm plan:link --id <wuId>
```

**Options:**

| Flag | Description | Required |
|------|-------------|----------|
| `-i, --id &lt;wuId&gt;` | Work Unit ID (e.g., WU-123). If not provided, auto-generates next sequential ID. | Yes |

### plan:promote

Promote plan to WU

```bash
pnpm plan:promote --id <wuId>
```

**Options:**

| Flag | Description | Required |
|------|-------------|----------|
| `-i, --id &lt;wuId&gt;` | Work Unit ID (e.g., WU-123). If not provided, auto-generates next sequential ID. | Yes |

## Setup & Development

### backlog:prune

Clean stale backlog entries

```bash
pnpm backlog:prune
```

### cloud:connect

Connect workspace.yaml to cloud control plane

```bash
pnpm cloud:connect
```

### config:get

Read and display a value from workspace.yaml software_delivery

```bash
pnpm config:get
```

### config:set

Safely update workspace.yaml software_delivery via micro-worktree

```bash
pnpm config:set
```

### file:delete

Delete file with audit trail

```bash
pnpm file:delete
```

### file:edit

Edit file with audit trail

```bash
pnpm file:edit
```

### file:read

Read file with audit trail

```bash
pnpm file:read
```

### file:write

Write file with audit trail

```bash
pnpm file:write
```

### git:branch

Show git branch with audit trail

```bash
pnpm git:branch
```

### git:diff

Show git diff with audit trail

```bash
pnpm git:diff
```

### git:log

Show git log with audit trail

```bash
pnpm git:log
```

### git:status

Show git status with audit trail

```bash
pnpm git:status
```

### lumenflow

Initialize LumenFlow in a project

```bash
pnpm lumenflow
```

### lumenflow:commands

List all available CLI commands

```bash
pnpm lumenflow:commands
```

### lumenflow:docs-sync

Sync agent docs (for upgrades)

```bash
pnpm lumenflow:docs-sync
```

### lumenflow:doctor

Diagnose LumenFlow configuration

```bash
pnpm lumenflow:doctor
```

### lumenflow:integrate

Generate enforcement hooks for client

```bash
pnpm lumenflow:integrate
```

### lumenflow:release

Run release workflow

```bash
pnpm lumenflow:release
```

### lumenflow:sync-templates

Sync templates to project

```bash
pnpm lumenflow:sync-templates
```

### lumenflow:upgrade

Upgrade LumenFlow packages

```bash
pnpm lumenflow:upgrade
```

## State Management

### state:bootstrap

Bootstrap state store

```bash
pnpm state:bootstrap
```

### state:cleanup

Clean up stale state data

```bash
pnpm state:cleanup
```

**Options:**

| Flag | Description | Required |
|------|-------------|----------|
| `--dry-run` | Preview cleanup without making changes | No |
| `--signals-only` | Only execute signal cleanup | No |
| `--memory-only` | Only execute memory cleanup | No |
| `--events-only` | Only execute event archival | No |
| `--json` | Output as JSON | No |
| `-q, --quiet` | Suppress output except errors and summary | No |
| `-b, --base-dir &lt;path&gt;` | Base directory (defaults to current directory) | No |

### state:doctor

Diagnose state store issues

```bash
pnpm state:doctor
```

**Options:**

| Flag | Description | Required |
|------|-------------|----------|
| `--fix` | Auto-repair safe issues | No |
| `--dry-run` | Preview repairs without making changes | No |
| `--json` | Output as JSON | No |
| `-q, --quiet` | Suppress output except errors and summary | No |
| `-b, --base-dir &lt;path&gt;` | Base directory (defaults to current directory) | No |

## WU Lifecycle

### wu:block

Block WU with reason

```bash
pnpm wu:block --id <wuId>
```

**Options:**

| Flag | Description | Required |
|------|-------------|----------|
| `-i, --id &lt;wuId&gt;` | Work Unit ID (e.g., WU-123). If not provided, auto-generates next sequential ID. | Yes |
| `-r, --reason &lt;reason&gt;` | Reason for action (required with --skip-gates, --override-owner) | No |
| `-w, --worktree &lt;path&gt;` | Override worktree path | No |
| `--remove-worktree` | Remove worktree when blocking | No |
| `--no-auto` | Skip auto-updating YAML/backlog/status | No |

### wu:brief

Generate handoff prompt for sub-agent WU execution

```bash
pnpm wu:brief
```

### wu:claim

Claim WU and create worktree

```bash
pnpm wu:claim --id <wuId> --lane <lane>
```

**Options:**

| Flag | Description | Required |
|------|-------------|----------|
| `-i, --id &lt;wuId&gt;` | Work Unit ID (e.g., WU-123). If not provided, auto-generates next sequential ID. | Yes |
| `-l, --lane &lt;lane&gt;` | Lane name (e.g., &quot;Operations: Tooling&quot;) | Yes |
| `-w, --worktree &lt;path&gt;` | Override worktree path | No |
| `-b, --branch &lt;branch&gt;` | Override branch name | No |
| `--branch-only` | Use branch-only mode (no worktree) | No |
| `--pr-mode` | Use PR mode (create PR instead of auto-merge) | No |
| `--no-auto` | Skip auto-updating YAML/backlog/status | No |
| `-f, --force` | Force operation | No |
| `--force-overlap` | Force claiming despite overlap (requires --reason) | No |
| `--fix` | Auto-fix common YAML validation issues (WU-1359) | No |
| `-r, --reason &lt;reason&gt;` | Reason for action (required with --skip-gates, --override-owner) | No |
| `--allow-incomplete` | Allow claiming with incomplete spec (bypasses spec completeness, NOT schema errors) | No |
| `--cloud` | Use cloud/branch-pr mode (no worktree, PR-based completion for cloud agents and MCP callers) | No |
| `--resume` | Resume a WU from a crashed/killed agent (handoff) by taking over the existing worktree and updating the lock with new PID. Fails if original PID is still running (safety) or worktree does not exist. | No |
| `--skip-setup` | Skip automatic pnpm install in worktree after creation (faster claims when deps already built) | No |
| `--no-push` | Skip pushing claim branch or canonical updates (air-gapped/offline) | No |

### wu:create

Create new WU spec

```bash
pnpm wu:create --lane <lane> --title <title>
```

**Options:**

| Flag | Description | Required |
|------|-------------|----------|
| `-i, --id &lt;wuId&gt;` | Work Unit ID (e.g., WU-123). If not provided, auto-generates next sequential ID. | No |
| `-l, --lane &lt;lane&gt;` | Lane name (e.g., &quot;Operations: Tooling&quot;) | Yes |
| `-t, --title &lt;title&gt;` | Work Unit title | Yes |
| `-p, --priority &lt;priority&gt;` | Priority level (P0, P1, P2, P3) | No |
| `--type &lt;type&gt;` | WU type (feature, bug, refactor, documentation) | No |
| `--initiative &lt;ref&gt;` | Parent initiative (INIT-XXX or slug) | No |
| `--phase &lt;number&gt;` | Phase number within initiative | No |
| `--blocked-by &lt;wuIds&gt;` | WU IDs that block this WU (repeatable) | No |
| `--blocks &lt;wuIds&gt;` | WU IDs this WU blocks (repeatable) | No |
| `--labels &lt;labels&gt;` | Labels (repeatable) | No |
| `--assigned-to &lt;email&gt;` | Override assigned_to (defaults to git config user.email) | No |
| `--description &lt;text&gt;` | WU description text (Context/Problem/Solution) | No |
| `--acceptance &lt;criterion&gt;` | Acceptance criterion (repeatable, use multiple times) | No |
| `--notes &lt;text&gt;` | Implementation notes or context (optional) | No |
| `--code-paths &lt;paths&gt;` | Code paths (repeatable) | No |
| `--test-paths-manual &lt;tests&gt;` | Manual test descriptions (repeatable) | No |
| `--test-paths-unit &lt;paths&gt;` | Unit test file paths (repeatable) | No |
| `--test-paths-e2e &lt;paths&gt;` | E2E test file paths (repeatable) | No |
| `--validate` | Validate spec completeness (requires description, acceptance, test paths) | No |
| `--spec-refs &lt;paths&gt;` | Spec/plan references (repeatable or comma-separated, required for type: feature) | No |
| `--exposure &lt;type&gt;` | Exposure level (ui, api, backend-only, documentation) | No |
| `--user-journey &lt;text&gt;` | User journey description (recommended for ui/api exposure) | No |
| `--ui-pairing-wus &lt;wuIds&gt;` | UI WU IDs that consume this API (repeatable or comma-separated, for api exposure) | No |
| `--plan` | Create plan template in $LUMENFLOW_HOME/plans/ (external plan storage) | No |
| `--estimated-files &lt;count&gt;` | Optional sizing estimate: expected number of files to modify (non-negative integer) | No |
| `--estimated-tool-calls &lt;count&gt;` | Optional sizing estimate: expected number of tool calls (non-negative integer) | No |
| `--sizing-strategy &lt;strategy&gt;` | Optional sizing strategy (single-session, checkpoint-resume, orchestrator-worker, decomposition) | No |
| `--sizing-exception-type &lt;type&gt;` | Optional sizing exception type when thresholds are exceeded (docs-only, shallow-multi-file) | No |
| `--sizing-exception-reason &lt;text&gt;` | Optional sizing exception justification text | No |
| `--no-strict` | Bypass strict validation (skip code_paths/test_paths existence checks, treat warnings as advisory). Logged when used. | No |
| `--cloud` | Use cloud/branch-pr mode (no worktree, PR-based completion for cloud agents and MCP callers) | No |

### wu:delegate

Generate delegation prompt and record explicit lineage intent

```bash
pnpm wu:delegate
```

### wu:done

Complete WU (merge, stamp, cleanup) from main

```bash
pnpm wu:done
```

### wu:edit

Edit WU spec fields

```bash
pnpm wu:edit --id <wuId>
```

**Options:**

| Flag | Description | Required |
|------|-------------|----------|
| `-i, --id &lt;wuId&gt;` | Work Unit ID (e.g., WU-123). If not provided, auto-generates next sequential ID. | Yes |
| `--test-paths-manual &lt;tests&gt;` | Manual test descriptions (repeatable) | No |
| `--test-paths-unit &lt;paths&gt;` | Unit test file paths (repeatable) | No |
| `--test-paths-e2e &lt;paths&gt;` | E2E test file paths (repeatable) | No |
| `--exposure &lt;type&gt;` | Exposure level (ui, api, backend-only, documentation) | No |
| `--no-strict` | Bypass strict validation (skip code_paths/test_paths existence checks, treat warnings as advisory). Logged when used. | No |
| `--spec-file &lt;path&gt;` | Path to YAML file with updated spec content | No |
| `--description &lt;text&gt;` | New description text (replaces existing) | No |
| `--acceptance &lt;criterion&gt;` | Acceptance criterion (repeatable, appends to existing; use --replace-acceptance to overwrite) | No |
| `--notes &lt;text&gt;` | Notes text (appends to existing; use --replace-notes to overwrite) | No |
| `--replace-notes` | Replace existing notes instead of appending | No |
| `--replace-acceptance` | Replace existing acceptance criteria instead of appending | No |
| `--code-paths &lt;path&gt;` | Code path (repeatable, appends to existing; use --replace-code-paths to overwrite) | No |
| `--replace-code-paths` | Replace existing code_paths instead of appending | No |
| `--risks &lt;risk&gt;` | Risk entry (repeatable, appends to existing; use --replace-risks to overwrite) | No |
| `--replace-risks` | Replace existing risks instead of appending | No |
| `--append` | [DEPRECATED] Arrays now append by default. Use --replace-* flags to replace. | No |
| `--lane &lt;lane&gt;` | New lane assignment (e.g., &quot;Operations: Tooling&quot;) | No |
| `--type &lt;type&gt;` | New WU type (feature, bug, refactor, documentation) | No |
| `--priority &lt;priority&gt;` | New priority (P0, P1, P2, P3) | No |
| `--initiative &lt;initId&gt;` | Initiative ID (e.g., INIT-001). Updates WU and initiative wus: arrays bidirectionally. | No |
| `--phase &lt;number&gt;` | Phase number within initiative (e.g., 1, 2) | No |
| `--blocked-by &lt;wuIds&gt;` | Comma-separated WU IDs that block this WU (appends to existing; use --replace-blocked-by to overwrite) | No |
| `--replace-blocked-by` | Replace existing blocked_by instead of appending | No |
| `--add-dep &lt;wuIds&gt;` | Comma-separated WU IDs to add to dependencies array (appends to existing; use --replace-dependencies to overwrite) | No |
| `--replace-dependencies` | Replace existing dependencies instead of appending | No |
| `--plan &lt;uri&gt;` | Plan file URI (lumenflow://plans/... or repo-relative path) | No |

### wu:prep

Run gates in worktree, prep for wu:done

```bash
pnpm wu:prep --id <wuId>
```

**Options:**

| Flag | Description | Required |
|------|-------------|----------|
| `-i, --id &lt;wuId&gt;` | Work Unit ID (e.g., WU-123). If not provided, auto-generates next sequential ID. | Yes |
| `--docs-only` | Run docs-only gates (format, spec-linter) | No |
| `--full-tests` | Run full incremental test suite (disable tests.unit scoped execution) | No |

### wu:recover

Analyze and fix WU state inconsistencies

```bash
pnpm wu:recover --id <wuId>
```

**Options:**

| Flag | Description | Required |
|------|-------------|----------|
| `-i, --id &lt;wuId&gt;` | Work Unit ID (e.g., WU-123). If not provided, auto-generates next sequential ID. | Yes |

### wu:release

Release orphaned WU (in_progress to ready)

```bash
pnpm wu:release --id <wuId> --reason <reason>
```

**Options:**

| Flag | Description | Required |
|------|-------------|----------|
| `-i, --id &lt;wuId&gt;` | Work Unit ID (e.g., WU-123). If not provided, auto-generates next sequential ID. | Yes |
| `-r, --reason &lt;reason&gt;` | Reason for action (required with --skip-gates, --override-owner) | Yes |

### wu:sandbox

Run command through hardened WU sandbox backend

```bash
pnpm wu:sandbox --id <wuId>
```

**Options:**

| Flag | Description | Required |
|------|-------------|----------|
| `-i, --id &lt;wuId&gt;` | Work Unit ID (e.g., WU-123). If not provided, auto-generates next sequential ID. | Yes |
| `-w, --worktree &lt;path&gt;` | Override worktree path | No |

### wu:status

Show WU status, location, valid commands

```bash
pnpm wu:status
```

### wu:unblock

Unblock WU

```bash
pnpm wu:unblock --id <wuId>
```

**Options:**

| Flag | Description | Required |
|------|-------------|----------|
| `-i, --id &lt;wuId&gt;` | Work Unit ID (e.g., WU-123). If not provided, auto-generates next sequential ID. | Yes |
| `-r, --reason &lt;reason&gt;` | Reason for action (required with --skip-gates, --override-owner) | No |
| `--create-worktree` | Create worktree when unblocking | No |
| `-w, --worktree &lt;path&gt;` | Override worktree path | No |
| `-b, --branch &lt;branch&gt;` | Override branch name | No |
| `--no-auto` | Skip auto-updating YAML/backlog/status | No |
| `-f, --force` | Force operation | No |

### wu:validate

Validate WU spec

```bash
pnpm wu:validate
```

**Options:**

| Flag | Description | Required |
|------|-------------|----------|
| `-i, --id &lt;wuId&gt;` | Work Unit ID (e.g., WU-123). If not provided, auto-generates next sequential ID. | No |
| `--no-strict` | Bypass strict validation (skip code_paths/test_paths existence checks, treat warnings as advisory). Logged when used. | No |

## WU Maintenance

### wu:cleanup

Cleanup after PR merge

```bash
pnpm wu:cleanup
```

**Options:**

| Flag | Description | Required |
|------|-------------|----------|
| `-i, --id &lt;wuId&gt;` | Work Unit ID (e.g., WU-123). If not provided, auto-generates next sequential ID. | No |
| `--artifacts` | Remove build artifacts (dist, tsbuildinfo) in current worktree | No |

### wu:delete

Delete WU spec and cleanup

```bash
pnpm wu:delete
```

**Options:**

| Flag | Description | Required |
|------|-------------|----------|
| `-i, --id &lt;wuId&gt;` | Work Unit ID (e.g., WU-123). If not provided, auto-generates next sequential ID. | No |
| `--dry-run` | Show what would be deleted without making changes | No |
| `--batch &lt;ids&gt;` | Delete multiple WUs atomically (comma-separated: WU-1,WU-2,WU-3) | No |

### wu:deps

Show WU dependencies

```bash
pnpm wu:deps
```

**Options:**

| Flag | Description | Required |
|------|-------------|----------|
| `-i, --id &lt;wuId&gt;` | Work Unit ID (e.g., WU-123). If not provided, auto-generates next sequential ID. | No |
| `--format &lt;format&gt;` | Output format (table, json, ascii, mermaid) | No |
| `-d, --depth &lt;number&gt;` | Maximum traversal depth | No |
| `--direction &lt;dir&gt;` | Graph direction (up, down, both) | No |

### wu:infer-lane

Infer lane from code paths/description

```bash
pnpm wu:infer-lane
```

### wu:preflight

Pre-flight checks before wu:done

```bash
pnpm wu:preflight --id <wuId>
```

**Options:**

| Flag | Description | Required |
|------|-------------|----------|
| `-i, --id &lt;wuId&gt;` | Work Unit ID (e.g., WU-123). If not provided, auto-generates next sequential ID. | Yes |
| `-w, --worktree &lt;path&gt;` | Override worktree path | No |

### wu:proto

Create WU prototype

```bash
pnpm wu:proto --lane <lane> --title <title>
```

**Options:**

| Flag | Description | Required |
|------|-------------|----------|
| `-l, --lane &lt;lane&gt;` | Lane name (e.g., &quot;Operations: Tooling&quot;) | Yes |
| `-t, --title &lt;title&gt;` | Work Unit title | Yes |
| `--description &lt;text&gt;` | WU description text (Context/Problem/Solution) | No |
| `--code-paths &lt;paths&gt;` | Code paths (repeatable) | No |
| `--labels &lt;labels&gt;` | Labels (repeatable) | No |
| `--assigned-to &lt;email&gt;` | Override assigned_to (defaults to git config user.email) | No |

### wu:prune

Clean stale worktrees

```bash
pnpm wu:prune
```

### wu:repair

Repair WU state issues

```bash
pnpm wu:repair
```

### wu:unlock-lane

Unlock stuck lane

```bash
pnpm wu:unlock-lane
```

**Options:**

| Flag | Description | Required |
|------|-------------|----------|
| `-l, --lane &lt;lane&gt;` | Lane name (e.g., &quot;Operations: Tooling&quot;) | No |
| `-r, --reason &lt;reason&gt;` | Reason for action (required with --skip-gates, --override-owner) | No |
| `-f, --force` | Force operation | No |

---

## Next Steps

- [Configuration](/reference/config) – Configure LumenFlow
- [WU Schema](/reference/wu-schema) – Work Unit YAML structure
