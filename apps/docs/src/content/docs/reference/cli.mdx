---
title: CLI Commands
description: Complete CLI reference for LumenFlow
---

{/* AUTO-GENERATED FILE - DO NOT EDIT DIRECTLY */}
{/* Run `pnpm docs:generate` to regenerate from source */}
{/* Includes formatting stabilization (WU-1157) */}

import { Aside, Tabs, TabItem } from '@astrojs/starlight/components';

LumenFlow provides a comprehensive CLI for managing Work Units, memory, initiatives, and more.

<Aside type="tip">All commands can be run via `pnpm command` (e.g., `pnpm wu:claim`).</Aside>

## Commands Overview

| Category        | Commands                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
| --------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Agent Lifecycle | [`agent:issues-query`](#agentissues-query), [`agent:log-issue`](#agentlog-issue), [`agent:session`](#agentsession), [`agent:session-end`](#agentsession-end)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| Flow Metrics    | [`flow:bottlenecks`](#flowbottlenecks), [`flow:report`](#flowreport)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| Initiatives     | [`initiative:add-wu`](#initiativeadd-wu), [`initiative:bulk-assign-wus`](#initiativebulk-assign-wus), [`initiative:create`](#initiativecreate), [`initiative:edit`](#initiativeedit), [`initiative:list`](#initiativelist), [`initiative:plan`](#initiativeplan), [`initiative:status`](#initiativestatus)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| Memory Layer    | [`mem:checkpoint`](#memcheckpoint), [`mem:cleanup`](#memcleanup), [`mem:context`](#memcontext), [`mem:create`](#memcreate), [`mem:delete`](#memdelete), [`mem:export`](#memexport), [`mem:inbox`](#meminbox), [`mem:init`](#meminit), [`mem:ready`](#memready), [`mem:signal`](#memsignal), [`mem:start`](#memstart), [`mem:summarize`](#memsummarize), [`mem:triage`](#memtriage)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| Metrics         | [`metrics`](#metrics), [`metrics:snapshot`](#metricssnapshot)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| Orchestration   | [`orchestrate:init-status`](#orchestrateinit-status), [`orchestrate:initiative`](#orchestrateinitiative), [`orchestrate:monitor`](#orchestratemonitor)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| Other           | [`backlog:prune`](#backlogprune), [`deps:add`](#depsadd), [`deps:remove`](#depsremove), [`file:delete`](#filedelete), [`file:edit`](#fileedit), [`file:read`](#fileread), [`file:write`](#filewrite), [`git:branch`](#gitbranch), [`git:diff`](#gitdiff), [`git:log`](#gitlog), [`git:status`](#gitstatus), [`guard:locked`](#guardlocked), [`guard:main-branch`](#guardmain-branch), [`guard:worktree-commit`](#guardworktree-commit), [`init:plan`](#initplan), [`lane:health`](#lanehealth), [`lane:suggest`](#lanesuggest), [`plan:create`](#plancreate), [`plan:edit`](#planedit), [`plan:link`](#planlink), [`plan:promote`](#planpromote), [`rotate:progress`](#rotateprogress), [`session:coordinator`](#sessioncoordinator), [`signal:cleanup`](#signalcleanup), [`state:bootstrap`](#statebootstrap), [`state:cleanup`](#statecleanup), [`state:doctor`](#statedoctor), [`sync:templates`](#synctemplates), [`trace:gen`](#tracegen), [`validate`](#validate), [`validate:agent-skills`](#validateagent-skills), [`validate:agent-sync`](#validateagent-sync), [`validate:backlog-sync`](#validatebacklog-sync), [`validate:skills-spec`](#validateskills-spec) |
| Quality Gates   | [`gates`](#gates)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| Setup           | [`lumenflow`](#lumenflow), [`lumenflow:docs-sync`](#lumenflowdocs-sync), [`lumenflow:doctor`](#lumenflowdoctor), [`lumenflow:init`](#lumenflowinit), [`lumenflow:metrics`](#lumenflowmetrics), [`lumenflow:release`](#lumenflowrelease), [`lumenflow:sync-templates`](#lumenflowsync-templates), [`lumenflow:upgrade`](#lumenflowupgrade), [`lumenflow:validate`](#lumenflowvalidate)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
| Sub-Agents      | [`spawn:list`](#spawnlist)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| Work Units      | [`wu:block`](#wublock), [`wu:claim`](#wuclaim), [`wu:cleanup`](#wucleanup), [`wu:create`](#wucreate), [`wu:delete`](#wudelete), [`wu:deps`](#wudeps), [`wu:done`](#wudone), [`wu:edit`](#wuedit), [`wu:infer-lane`](#wuinfer-lane), [`wu:preflight`](#wupreflight), [`wu:prep`](#wuprep), [`wu:proto`](#wuproto), [`wu:prune`](#wuprune), [`wu:recover`](#wurecover), [`wu:release`](#wurelease), [`wu:repair`](#wurepair), [`wu:spawn`](#wuspawn), [`wu:status`](#wustatus), [`wu:unblock`](#wuunblock), [`wu:unlock-lane`](#wuunlock-lane), [`wu:validate`](#wuvalidate)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |

## Agent Lifecycle

### agent:issues-query

Query logged issues from agent sessions

```bash
pnpm agent:issues-query
```

### agent:log-issue

Log an issue encountered during agent work

```bash
pnpm agent:log-issue --category <cat> --severity <sev> --title <title> --description <desc>
```

**Options:**

| Flag                         | Description                                  | Required |
| ---------------------------- | -------------------------------------------- | -------- | --------- | --------- | ------ | --- |
| `--category &lt;cat&gt;`     | Issue category (workflow                     | tooling  | confusion | violation | error) | Yes |
| `--severity &lt;sev&gt;`     | Severity level (blocker                      | major    | minor     | info)     | Yes    |
| `--title &lt;title&gt;`      | Short description (5-100 chars)              | Yes      |
| `--description &lt;desc&gt;` | Detailed context (10-2000 chars)             | Yes      |
| `--resolution &lt;res&gt;`   | How the issue was resolved                   | No       |
| `--tag &lt;tag&gt;`          | Tag for categorization (repeatable)          | No       |
| `--step &lt;step&gt;`        | Current workflow step (e.g., wu:done, gates) | No       |
| `--file &lt;file&gt;`        | Related file path (repeatable)               | No       |

### agent:session

Start an agent session for a WU

```bash
pnpm agent:session --wu <wuId> --tier <tier>
```

**Options:**

| Flag                        | Description                       | Required |
| --------------------------- | --------------------------------- | -------- |
| `--wu &lt;wuId&gt;`         | WU ID to work on (e.g., WU-1234)  | Yes      |
| `--tier &lt;tier&gt;`       | Context tier (1, 2, or 3)         | Yes      |
| `--agent-type &lt;type&gt;` | Agent type (default: claude-code) | No       |

### agent:session-end

End an agent session

```bash
pnpm agent:session-end
```

## Flow Metrics

### flow:bottlenecks

Identify workflow bottlenecks and critical path

```bash
pnpm flow:bottlenecks
```

### flow:report

Generate DORA metrics flow report

```bash
pnpm flow:report
```

## Initiatives

### initiative:add-wu

Link a WU to an initiative bidirectionally

```bash
pnpm initiative:add-wu --initiative <ref> --wu <wuId>
```

**Options:**

| Flag                       | Description                          | Required |
| -------------------------- | ------------------------------------ | -------- |
| `--initiative &lt;ref&gt;` | Parent initiative (INIT-XXX or slug) | Yes      |
| `--wu &lt;wuId&gt;`        | Work Unit ID to link (e.g., WU-123)  | Yes      |

### initiative:bulk-assign-wus

Bulk-assign orphaned WUs to initiatives based on lane prefix rules

```bash
pnpm initiative:bulk-assign-wus
```

**Options:**

| Flag                     | Description                                                     | Required |
| ------------------------ | --------------------------------------------------------------- | -------- |
| `--config &lt;path&gt;`  | Path to config file (tool-specific)                             | No       |
| `--apply`                | Apply changes (default is dry-run)                              | No       |
| `--sync-from-initiative` | Ensure WU initiative fields exist for WUs listed in initiatives | No       |

### initiative:create

Create a new Initiative with micro-worktree isolation (race-safe)

```bash
pnpm initiative:create --id <wuId> --slug <slug> --title <title>
```

**Options:**

| Flag                              | Description                                                                      | Required |
| --------------------------------- | -------------------------------------------------------------------------------- | -------- |
| `-i, --id &lt;wuId&gt;`           | Work Unit ID (e.g., WU-123). If not provided, auto-generates next sequential ID. | Yes      |
| `-s, --slug &lt;slug&gt;`         | Initiative slug (kebab-case)                                                     | Yes      |
| `-t, --title &lt;title&gt;`       | Work Unit title                                                                  | Yes      |
| `-p, --priority &lt;priority&gt;` | Priority level (P0, P1, P2, P3)                                                  | No       |
| `-o, --owner &lt;owner&gt;`       | Initiative owner (team or individual)                                            | No       |
| `--target-date &lt;date&gt;`      | Target completion date (YYYY-MM-DD)                                              | No       |

### initiative:edit

Edit Initiative YAML files with micro-worktree isolation

```bash
pnpm initiative:edit
```

### initiative:list

List all initiatives with progress percentages

```bash
pnpm initiative:list
```

**Options:**

| Flag                      | Description                                 | Required |
| ------------------------- | ------------------------------------------- | -------- |
| `--format &lt;format&gt;` | Output format (table, json, ascii, mermaid) | No       |
| `--status &lt;status&gt;` | Filter by status                            | No       |
| `--color`                 | Enable colored output                       | No       |

### initiative:plan

Link a plan file to an initiative

```bash
pnpm initiative:plan --initiative <ref>
```

**Options:**

| Flag                       | Description                          | Required |
| -------------------------- | ------------------------------------ | -------- |
| `--initiative &lt;ref&gt;` | Parent initiative (INIT-XXX or slug) | Yes      |

### initiative:status

Show detailed initiative view with phases and WUs

```bash
pnpm initiative:status
```

**Options:**

| Flag                      | Description                                                                      | Required |
| ------------------------- | -------------------------------------------------------------------------------- | -------- |
| `-i, --id &lt;wuId&gt;`   | Work Unit ID (e.g., WU-123). If not provided, auto-generates next sequential ID. | No       |
| `--format &lt;format&gt;` | Output format (table, json, ascii, mermaid)                                      | No       |
| `--color`                 | Enable colored output                                                            | No       |

## Memory Layer

### mem:checkpoint

Create a checkpoint node for context snapshots

```bash
pnpm mem:checkpoint
```

**Options:**

| Flag                | Description                         | Required |
| ------------------- | ----------------------------------- | -------- |
| `--wu &lt;wuId&gt;` | Work Unit ID to link (e.g., WU-123) | No       |

### mem:cleanup

Prune closed memory nodes based on lifecycle policy and TTL

```bash
pnpm mem:cleanup
```

### mem:context

Generate context injection block for wu:spawn prompts

```bash
pnpm mem:context --wu <wuId>
```

**Options:**

| Flag                | Description                         | Required |
| ------------------- | ----------------------------------- | -------- |
| `--wu &lt;wuId&gt;` | Work Unit ID to link (e.g., WU-123) | Yes      |

### mem:create

Create a memory node with optional provenance tracking

```bash
pnpm mem:create
```

**Options:**

| Flag                | Description                         | Required |
| ------------------- | ----------------------------------- | -------- |
| `--wu &lt;wuId&gt;` | Work Unit ID to link (e.g., WU-123) | No       |

### mem:delete

Delete memory nodes (soft delete via metadata.status=deleted)

```bash
pnpm mem:delete
```

### mem:export

Export memory nodes as markdown or JSON

```bash
pnpm mem:export
```

**Options:**

| Flag                | Description                         | Required |
| ------------------- | ----------------------------------- | -------- |
| `--wu &lt;wuId&gt;` | Work Unit ID to link (e.g., WU-123) | No       |

### mem:inbox

Read coordination signals from other agents

```bash
pnpm mem:inbox
```

**Options:**

| Flag                      | Description                             | Required |
| ------------------------- | --------------------------------------- | -------- |
| `--wu &lt;wuId&gt;`       | Work Unit ID to link (e.g., WU-123)     | No       |
| `-l, --lane &lt;lane&gt;` | Lane name (e.g., "Operations: Tooling") | No       |

### mem:init

Initialize memory layer in repository

```bash
pnpm mem:init
```

### mem:ready

Query ready nodes for a WU (deterministic ordering)

```bash
pnpm mem:ready --wu <wuId>
```

**Options:**

| Flag                | Description                         | Required |
| ------------------- | ----------------------------------- | -------- |
| `--wu &lt;wuId&gt;` | Work Unit ID to link (e.g., WU-123) | Yes      |

### mem:signal

Send a coordination signal to other agents

```bash
pnpm mem:signal
```

**Options:**

| Flag                      | Description                             | Required |
| ------------------------- | --------------------------------------- | -------- |
| `--wu &lt;wuId&gt;`       | Work Unit ID to link (e.g., WU-123)     | No       |
| `-l, --lane &lt;lane&gt;` | Lane name (e.g., "Operations: Tooling") | No       |

### mem:start

Create a session node linked to a WU

```bash
pnpm mem:start --wu <wuId>
```

**Options:**

| Flag                | Description                         | Required |
| ------------------- | ----------------------------------- | -------- |
| `--wu &lt;wuId&gt;` | Work Unit ID to link (e.g., WU-123) | Yes      |

### mem:summarize

Rollup older memory nodes into summary nodes for compaction

```bash
pnpm mem:summarize
```

### mem:triage

Review discovery nodes and promote to WUs or archive

```bash
pnpm mem:triage
```

## Metrics

### metrics

Unified Metrics CLI with subcommands (WU-1110)

```bash
pnpm metrics
```

### metrics:snapshot

Capture current metrics snapshot for dashboards

```bash
pnpm metrics:snapshot
```

## Orchestration

### orchestrate:init-status

Show initiative orchestration status

```bash
pnpm orchestrate:init-status
```

### orchestrate:initiative

Orchestrate initiative execution with agents

```bash
pnpm orchestrate:initiative
```

### orchestrate:monitor

Monitor spawned agent progress and signals

```bash
pnpm orchestrate:monitor
```

## Other

### backlog:prune

Backlog Prune Command

```bash
pnpm backlog:prune
```

### deps:add

Deps Add CLI Command

```bash
pnpm deps:add
```

### deps:remove

Deps Remove CLI Command

```bash
pnpm deps:remove
```

### file:delete

File Delete CLI Tool

```bash
pnpm file:delete
```

### file:edit

File Edit CLI Tool

```bash
pnpm file:edit
```

### file:read

File Read CLI Tool

```bash
pnpm file:read
```

### file:write

File Write CLI Tool

```bash
pnpm file:write
```

### git:branch

Git Branch CLI Tool

```bash
pnpm git:branch
```

### git:diff

Git Diff CLI Tool

```bash
pnpm git:diff
```

### git:log

Git Log CLI Tool

```bash
pnpm git:log
```

### git:status

Git Status CLI Tool

```bash
pnpm git:status
```

### guard:locked

```bash
pnpm guard:locked
```

### guard:main-branch

Guard Main Branch CLI Tool

```bash
pnpm guard:main-branch
```

### guard:worktree-commit

```bash
pnpm guard:worktree-commit
```

### init:plan

Link a plan file to an initiative

```bash
pnpm init:plan --initiative <ref>
```

**Options:**

| Flag                       | Description                          | Required |
| -------------------------- | ------------------------------------ | -------- |
| `--initiative &lt;ref&gt;` | Parent initiative (INIT-XXX or slug) | Yes      |

### lane:health

Check lane configuration health (WU-1188)

```bash
pnpm lane:health
```

### lane:suggest

Suggest lane definitions based on codebase context

```bash
pnpm lane:suggest
```

### plan:create

Create a new plan file in repo plansDir

```bash
pnpm plan:create --id <wuId> --title <title>
```

**Options:**

| Flag                        | Description                                                                      | Required |
| --------------------------- | -------------------------------------------------------------------------------- | -------- |
| `-i, --id &lt;wuId&gt;`     | Work Unit ID (e.g., WU-123). If not provided, auto-generates next sequential ID. | Yes      |
| `-t, --title &lt;title&gt;` | Work Unit title                                                                  | Yes      |

### plan:edit

Edit a section in a plan file

```bash
pnpm plan:edit --id <wuId>
```

**Options:**

| Flag                    | Description                                                                      | Required |
| ----------------------- | -------------------------------------------------------------------------------- | -------- |
| `-i, --id &lt;wuId&gt;` | Work Unit ID (e.g., WU-123). If not provided, auto-generates next sequential ID. | Yes      |

### plan:link

Link a plan file to a WU or initiative

```bash
pnpm plan:link --id <wuId>
```

**Options:**

| Flag                    | Description                                                                      | Required |
| ----------------------- | -------------------------------------------------------------------------------- | -------- |
| `-i, --id &lt;wuId&gt;` | Work Unit ID (e.g., WU-123). If not provided, auto-generates next sequential ID. | Yes      |

### plan:promote

Promote a plan to approved status

```bash
pnpm plan:promote --id <wuId>
```

**Options:**

| Flag                    | Description                                                                      | Required |
| ----------------------- | -------------------------------------------------------------------------------- | -------- |
| `-i, --id &lt;wuId&gt;` | Work Unit ID (e.g., WU-123). If not provided, auto-generates next sequential ID. | Yes      |

### rotate:progress

Rotate Progress CLI Command

```bash
pnpm rotate:progress
```

### session:coordinator

Session Coordinator CLI Command

```bash
pnpm session:coordinator
```

### signal:cleanup

Prune old signals based on TTL policy to prevent unbounded growth

```bash
pnpm signal:cleanup
```

### state:bootstrap

State Bootstrap Command

```bash
pnpm state:bootstrap
```

### state:cleanup

Orchestrate all state cleanup: signals, memory, events

```bash
pnpm state:cleanup
```

### state:doctor

Check state integrity and optionally repair issues

```bash
pnpm state:doctor
```

### sync:templates

Sync internal docs to CLI templates for release-cycle maintenance

```bash
pnpm sync:templates
```

### trace:gen

Trace Generator CLI Command

```bash
pnpm trace:gen
```

### validate

```bash
pnpm validate
```

### validate:agent-skills

```bash
pnpm validate:agent-skills
```

### validate:agent-sync

```bash
pnpm validate:agent-sync
```

### validate:backlog-sync

```bash
pnpm validate:backlog-sync
```

### validate:skills-spec

```bash
pnpm validate:skills-spec
```

## Quality Gates

### gates

Run quality gates with support for docs-only mode, incremental linting, and tiered testing

```bash
pnpm gates
```

## Setup

### lumenflow

Initialize LumenFlow in a project

```bash
pnpm lumenflow
```

### lumenflow:docs-sync

Sync agent onboarding docs to existing projects (skips existing files by default)

```bash
pnpm lumenflow:docs-sync
```

### lumenflow:doctor

Check LumenFlow safety components and configuration

```bash
pnpm lumenflow:doctor
```

### lumenflow:init

Initialize LumenFlow in a project

```bash
pnpm lumenflow:init
```

### lumenflow:metrics

Unified Metrics CLI with subcommands (WU-1110)

```bash
pnpm lumenflow:metrics
```

### lumenflow:release

Release Command

```bash
pnpm lumenflow:release
```

### lumenflow:sync-templates

Sync internal docs to CLI templates for release-cycle maintenance

```bash
pnpm lumenflow:sync-templates
```

### lumenflow:upgrade

LumenFlow Upgrade CLI Command

```bash
pnpm lumenflow:upgrade
```

### lumenflow:validate

```bash
pnpm lumenflow:validate
```

## Sub-Agents

### spawn:list

Display spawn trees for WUs or initiatives

```bash
pnpm spawn:list
```

**Options:**

| Flag                | Description                         | Required |
| ------------------- | ----------------------------------- | -------- |
| `--wu &lt;wuId&gt;` | Work Unit ID to link (e.g., WU-123) | No       |

## Work Units

### wu:block

Block a work unit and move it from in-progress to blocked status

```bash
pnpm wu:block --id <wuId>
```

**Options:**

| Flag                          | Description                                                                      | Required |
| ----------------------------- | -------------------------------------------------------------------------------- | -------- |
| `-i, --id &lt;wuId&gt;`       | Work Unit ID (e.g., WU-123). If not provided, auto-generates next sequential ID. | Yes      |
| `-r, --reason &lt;reason&gt;` | Reason for action (required with --skip-gates, --override-owner)                 | No       |
| `-w, --worktree &lt;path&gt;` | Override worktree path                                                           | No       |
| `--remove-worktree`           | Remove worktree when blocking                                                    | No       |
| `--no-auto`                   | Skip auto-updating YAML/backlog/status                                           | No       |

### wu:claim

Claim a work unit by creating a worktree/branch and updating status

```bash
pnpm wu:claim --id <wuId> --lane <lane>
```

**Options:**

| Flag                          | Description                                                                                                                                                                                            | Required |
| ----------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ | -------- |
| `-i, --id &lt;wuId&gt;`       | Work Unit ID (e.g., WU-123). If not provided, auto-generates next sequential ID.                                                                                                                       | Yes      |
| `-l, --lane &lt;lane&gt;`     | Lane name (e.g., "Operations: Tooling")                                                                                                                                                                | Yes      |
| `-w, --worktree &lt;path&gt;` | Override worktree path                                                                                                                                                                                 | No       |
| `-b, --branch &lt;branch&gt;` | Override branch name                                                                                                                                                                                   | No       |
| `--branch-only`               | Use branch-only mode (no worktree)                                                                                                                                                                     | No       |
| `--pr-mode`                   | Use PR mode (create PR instead of auto-merge)                                                                                                                                                          | No       |
| `--no-auto`                   | Skip auto-updating YAML/backlog/status                                                                                                                                                                 | No       |
| `-f, --force`                 | Force operation                                                                                                                                                                                        | No       |
| `--force-overlap`             | Force claiming despite overlap (requires --reason)                                                                                                                                                     | No       |
| `--fix`                       | Auto-fix common YAML validation issues (WU-1359)                                                                                                                                                       | No       |
| `-r, --reason &lt;reason&gt;` | Reason for action (required with --skip-gates, --override-owner)                                                                                                                                       | No       |
| `--allow-incomplete`          | Allow claiming with incomplete spec (bypasses spec completeness, NOT schema errors)                                                                                                                    | No       |
| `--resume`                    | Resume a WU from a crashed/killed agent (handoff) by taking over the existing worktree and updating the lock with new PID. Fails if original PID is still running (safety) or worktree does not exist. | No       |
| `--skip-setup`                | Skip automatic pnpm install in worktree after creation (faster claims when deps already built)                                                                                                         | No       |
| `--no-push`                   | Skip pushing claim branch or canonical updates (air-gapped/offline)                                                                                                                                    | No       |

### wu:cleanup

Clean up worktree and branch after PR merge (PR-based completion workflow)

```bash
pnpm wu:cleanup
```

**Options:**

| Flag                    | Description                                                                      | Required |
| ----------------------- | -------------------------------------------------------------------------------- | -------- |
| `-i, --id &lt;wuId&gt;` | Work Unit ID (e.g., WU-123). If not provided, auto-generates next sequential ID. | No       |

### wu:create

Create a new Work Unit with micro-worktree isolation (race-safe)

```bash
pnpm wu:create --lane <lane> --title <title>
```

**Options:**

| Flag                                | Description                                                                                                           | Required |
| ----------------------------------- | --------------------------------------------------------------------------------------------------------------------- | -------- |
| `-i, --id &lt;wuId&gt;`             | Work Unit ID (e.g., WU-123). If not provided, auto-generates next sequential ID.                                      | No       |
| `-l, --lane &lt;lane&gt;`           | Lane name (e.g., "Operations: Tooling")                                                                               | Yes      |
| `-t, --title &lt;title&gt;`         | Work Unit title                                                                                                       | Yes      |
| `-p, --priority &lt;priority&gt;`   | Priority level (P0, P1, P2, P3)                                                                                       | No       |
| `--type &lt;type&gt;`               | WU type (feature, bug, refactor, documentation)                                                                       | No       |
| `--initiative &lt;ref&gt;`          | Parent initiative (INIT-XXX or slug)                                                                                  | No       |
| `--phase &lt;number&gt;`            | Phase number within initiative                                                                                        | No       |
| `--blocked-by &lt;wuIds&gt;`        | WU IDs that block this WU (repeatable)                                                                                | No       |
| `--blocks &lt;wuIds&gt;`            | WU IDs this WU blocks (repeatable)                                                                                    | No       |
| `--labels &lt;labels&gt;`           | Labels (repeatable)                                                                                                   | No       |
| `--assigned-to &lt;email&gt;`       | Override assigned_to (defaults to git config user.email)                                                              | No       |
| `--description &lt;text&gt;`        | WU description text (Context/Problem/Solution)                                                                        | No       |
| `--acceptance &lt;criterion&gt;`    | Acceptance criterion (repeatable, use multiple times)                                                                 | No       |
| `--code-paths &lt;paths&gt;`        | Code paths (repeatable)                                                                                               | No       |
| `--test-paths-manual &lt;tests&gt;` | Manual test descriptions (repeatable)                                                                                 | No       |
| `--test-paths-unit &lt;paths&gt;`   | Unit test file paths (repeatable)                                                                                     | No       |
| `--test-paths-e2e &lt;paths&gt;`    | E2E test file paths (repeatable)                                                                                      | No       |
| `--validate`                        | Validate spec completeness (requires description, acceptance, test paths)                                             | No       |
| `--spec-refs &lt;paths&gt;`         | Spec/plan references (repeatable or comma-separated, required for type: feature)                                      | No       |
| `--exposure &lt;type&gt;`           | Exposure level (ui, api, backend-only, documentation)                                                                 | No       |
| `--user-journey &lt;text&gt;`       | User journey description (recommended for ui/api exposure)                                                            | No       |
| `--ui-pairing-wus &lt;wuIds&gt;`    | UI WU IDs that consume this API (repeatable or comma-separated, for api exposure)                                     | No       |
| `--no-strict`                       | Bypass strict validation (skip code_paths/test_paths existence checks, treat warnings as advisory). Logged when used. | No       |
| `--plan`                            | Create plan template in $LUMENFLOW_HOME/plans/ (external plan storage)                                                | No       |

### wu:delete

Safely delete WU YAML files with micro-worktree isolation

```bash
pnpm wu:delete
```

**Options:**

| Flag                    | Description                                                                      | Required |
| ----------------------- | -------------------------------------------------------------------------------- | -------- |
| `-i, --id &lt;wuId&gt;` | Work Unit ID (e.g., WU-123). If not provided, auto-generates next sequential ID. | No       |

### wu:deps

Visualize WU dependency graph

```bash
pnpm wu:deps
```

**Options:**

| Flag                         | Description                                                                      | Required |
| ---------------------------- | -------------------------------------------------------------------------------- | -------- |
| `-i, --id &lt;wuId&gt;`      | Work Unit ID (e.g., WU-123). If not provided, auto-generates next sequential ID. | No       |
| `--format &lt;format&gt;`    | Output format (table, json, ascii, mermaid)                                      | No       |
| `-d, --depth &lt;number&gt;` | Maximum traversal depth                                                          | No       |
| `--direction &lt;dir&gt;`    | Graph direction (up, down, both)                                                 | No       |

### wu:done

WU Done Helper

```bash
pnpm wu:done
```

### wu:edit

Edit WU spec files with micro-worktree isolation

```bash
pnpm wu:edit --id <wuId>
```

**Options:**

| Flag                                | Description                                                                                                           | Required |
| ----------------------------------- | --------------------------------------------------------------------------------------------------------------------- | -------- |
| `-i, --id &lt;wuId&gt;`             | Work Unit ID (e.g., WU-123). If not provided, auto-generates next sequential ID.                                      | Yes      |
| `--test-paths-manual &lt;tests&gt;` | Manual test descriptions (repeatable)                                                                                 | No       |
| `--test-paths-unit &lt;paths&gt;`   | Unit test file paths (repeatable)                                                                                     | No       |
| `--test-paths-e2e &lt;paths&gt;`    | E2E test file paths (repeatable)                                                                                      | No       |
| `--exposure &lt;type&gt;`           | Exposure level (ui, api, backend-only, documentation)                                                                 | No       |
| `--no-strict`                       | Bypass strict validation (skip code_paths/test_paths existence checks, treat warnings as advisory). Logged when used. | No       |

### wu:infer-lane

WU Lane Inference CLI (WU-908)

```bash
pnpm wu:infer-lane
```

### wu:preflight

Fast validation of code_paths and test paths before gates run.

```bash
pnpm wu:preflight --id <wuId>
```

**Options:**

| Flag                          | Description                                                                      | Required |
| ----------------------------- | -------------------------------------------------------------------------------- | -------- |
| `-i, --id &lt;wuId&gt;`       | Work Unit ID (e.g., WU-123). If not provided, auto-generates next sequential ID. | Yes      |
| `-w, --worktree &lt;path&gt;` | Override worktree path                                                           | No       |

### wu:prep

Prepare WU for completion (run gates in worktree)

```bash
pnpm wu:prep --id <wuId>
```

**Options:**

| Flag                    | Description                                                                      | Required |
| ----------------------- | -------------------------------------------------------------------------------- | -------- |
| `-i, --id &lt;wuId&gt;` | Work Unit ID (e.g., WU-123). If not provided, auto-generates next sequential ID. | Yes      |

### wu:proto

Create and claim a prototype WU with relaxed validation (rapid prototyping)

```bash
pnpm wu:proto --lane <lane> --title <title>
```

**Options:**

| Flag                          | Description                                              | Required |
| ----------------------------- | -------------------------------------------------------- | -------- |
| `-l, --lane &lt;lane&gt;`     | Lane name (e.g., "Operations: Tooling")                  | Yes      |
| `-t, --title &lt;title&gt;`   | Work Unit title                                          | Yes      |
| `--description &lt;text&gt;`  | WU description text (Context/Problem/Solution)           | No       |
| `--code-paths &lt;paths&gt;`  | Code paths (repeatable)                                  | No       |
| `--labels &lt;labels&gt;`     | Labels (repeatable)                                      | No       |
| `--assigned-to &lt;email&gt;` | Override assigned_to (defaults to git config user.email) | No       |

### wu:prune

WU Prune Utility

```bash
pnpm wu:prune
```

### wu:recover

Analyze and fix WU state inconsistencies (WU-1090)

```bash
pnpm wu:recover --id <wuId>
```

**Options:**

| Flag                    | Description                                                                      | Required |
| ----------------------- | -------------------------------------------------------------------------------- | -------- |
| `-i, --id &lt;wuId&gt;` | Work Unit ID (e.g., WU-123). If not provided, auto-generates next sequential ID. | Yes      |

### wu:release

Release an orphaned WU from in_progress back to ready state for reclaiming

```bash
pnpm wu:release --id <wuId> --reason <reason>
```

**Options:**

| Flag                          | Description                                                                      | Required |
| ----------------------------- | -------------------------------------------------------------------------------- | -------- |
| `-i, --id &lt;wuId&gt;`       | Work Unit ID (e.g., WU-123). If not provided, auto-generates next sequential ID. | Yes      |
| `-r, --reason &lt;reason&gt;` | Reason for action (required with --skip-gates, --override-owner)                 | Yes      |

### wu:repair

WU State Repair Tool (Unified - WU-1826, WU-2240)

```bash
pnpm wu:repair
```

### wu:spawn

Generate Task tool invocation for sub-agent WU execution

```bash
pnpm wu:spawn --id <wuId>
```

**Options:**

| Flag                       | Description                                                                      | Required |
| -------------------------- | -------------------------------------------------------------------------------- | -------- |
| `-i, --id &lt;wuId&gt;`    | Work Unit ID (e.g., WU-123). If not provided, auto-generates next sequential ID. | Yes      |
| `--thinking`               | Enable extended thinking for sub-agent WU execution                              | No       |
| `--no-thinking`            | Explicitly disable extended thinking (default behavior)                          | No       |
| `--budget &lt;tokens&gt;`  | Token budget for extended thinking (requires --thinking)                         | No       |
| `--codex`                  | Output a Codex/GPT-friendly Markdown prompt (instead of Claude Task antml)       | No       |
| `--parent-wu &lt;wuId&gt;` | Parent WU ID for orchestrator context (e.g., WU-1000)                            | No       |
| `--client &lt;client&gt;`  | Client name (claude-code, gemini-cli, etc)                                       | No       |
| `--vendor &lt;vendor&gt;`  | Deprecated alias for --client                                                    | No       |
| `--no-context`             | Skip memory context injection in spawn prompts                                   | No       |

### wu:status

Show WU status, location, and valid commands (WU-1090)

```bash
pnpm wu:status
```

**Options:**

| Flag                    | Description                                                                      | Required |
| ----------------------- | -------------------------------------------------------------------------------- | -------- |
| `-i, --id &lt;wuId&gt;` | Work Unit ID (e.g., WU-123). If not provided, auto-generates next sequential ID. | No       |

### wu:unblock

Unblock a work unit and move it from blocked to in-progress status

```bash
pnpm wu:unblock --id <wuId>
```

**Options:**

| Flag                          | Description                                                                      | Required |
| ----------------------------- | -------------------------------------------------------------------------------- | -------- |
| `-i, --id &lt;wuId&gt;`       | Work Unit ID (e.g., WU-123). If not provided, auto-generates next sequential ID. | Yes      |
| `-r, --reason &lt;reason&gt;` | Reason for action (required with --skip-gates, --override-owner)                 | No       |
| `--create-worktree`           | Create worktree when unblocking                                                  | No       |
| `-w, --worktree &lt;path&gt;` | Override worktree path                                                           | No       |
| `-b, --branch &lt;branch&gt;` | Override branch name                                                             | No       |
| `--no-auto`                   | Skip auto-updating YAML/backlog/status                                           | No       |
| `-f, --force`                 | Force operation                                                                  | No       |

### wu:unlock-lane

Safely unlock a lane lock with audit logging

```bash
pnpm wu:unlock-lane
```

**Options:**

| Flag                          | Description                                                      | Required |
| ----------------------------- | ---------------------------------------------------------------- | -------- |
| `-l, --lane &lt;lane&gt;`     | Lane name (e.g., "Operations: Tooling")                          | No       |
| `-r, --reason &lt;reason&gt;` | Reason for action (required with --skip-gates, --override-owner) | No       |
| `-f, --force`                 | Force operation                                                  | No       |

### wu:validate

Validate WU YAML files against schema (strict mode by default, WU-1329)

```bash
pnpm wu:validate
```

**Options:**

| Flag                    | Description                                                                                                           | Required |
| ----------------------- | --------------------------------------------------------------------------------------------------------------------- | -------- |
| `-i, --id &lt;wuId&gt;` | Work Unit ID (e.g., WU-123). If not provided, auto-generates next sequential ID.                                      | No       |
| `--no-strict`           | Bypass strict validation (skip code_paths/test_paths existence checks, treat warnings as advisory). Logged when used. | No       |

---

## Next Steps

- [Configuration](/reference/config)  Configure LumenFlow
- [WU Schema](/reference/wu-schema)  Work Unit YAML structure
