---
title: Upgrading LumenFlow
description: How to upgrade LumenFlow packages to the latest version
---

import { Steps, Tabs, TabItem, Aside, Badge } from '@astrojs/starlight/components';

This guide covers how to upgrade your LumenFlow installation to the latest version.

## Quick Upgrade (Recommended)

The fastest way to upgrade all LumenFlow packages is with the built-in upgrade command.

```bash
pnpm lumenflow:upgrade --latest
```

This command:

- Updates all `@lumenflow/*` packages atomically
- Uses micro-worktree isolation (no WU needed)
- Updates both `package.json` and `pnpm-lock.yaml`
- Works from your main checkout

<Aside type="tip">
  The upgrade command handles version coordination automatically. All packages (except
  `@lumenflow/metrics`) are versioned together for compatibility.
</Aside>

## Manual Upgrade

If you prefer manual control or encounter issues with the upgrade command, you can update packages directly.

<Tabs syncKey="pkg">
  <TabItem label="pnpm">

```bash
pnpm up @lumenflow/core @lumenflow/cli @lumenflow/kernel \
  @lumenflow/runtime @lumenflow/packs @lumenflow/mcp \
  @lumenflow/memory @lumenflow/agent @lumenflow/initiatives \
  @lumenflow/metrics @lumenflow/shims \
  @lumenflow/control-plane-sdk --latest
```

  </TabItem>
  <TabItem label="npm">

```bash
npm update @lumenflow/core @lumenflow/cli @lumenflow/kernel \
  @lumenflow/runtime @lumenflow/packs @lumenflow/mcp \
  @lumenflow/memory @lumenflow/agent @lumenflow/initiatives \
  @lumenflow/metrics @lumenflow/shims \
  @lumenflow/control-plane-sdk
```

  </TabItem>
</Tabs>

## Post-Upgrade Steps

After upgrading, sync your agent documentation to get the latest skills and guidance.

<Steps>

1. **Sync agent documentation**

   ```bash
   pnpm exec lumenflow docs:sync --force
   ```

   This updates:
   - `.lumenflow/agents/` — Vendor-agnostic agent guidance
   - `.claude/skills/` — Claude Code skills (if present)
   - `LUMENFLOW.md` — Workflow entry point

2. **Verify the upgrade**

   ```bash
   pnpm list @lumenflow/cli
   ```

3. **Check for config changes**

   Review the [Changelog](/reference/changelog) for any breaking changes that may require config updates.

</Steps>

## Upgrading to v3.0.0

<Badge text="Current" variant="success" />

Version 3.0.0 introduces the kernel/pack architecture, 14 granular lanes, and 5 new packages. See the [Changelog](/reference/changelog) for full details.

### Upgrade Steps

```bash
# 1. Upgrade packages
pnpm lumenflow:upgrade --latest

# 2. Sync documentation
pnpm exec lumenflow docs:sync --force

# 3. Create workspace.yaml (new in v3.0)
# See the Workspace Spec reference for schema details

# 4. Verify
pnpm list @lumenflow/cli  # Should show 3.0.0
```

### Breaking Changes in v3.0.0

- **Removed `isAgentBranchSync()`** — Use async `isAgentBranch()` instead
- **Removed single-word lane names** — All lanes must use "Parent: Sublane" format
- **Removed config `version: '1.0'`** — Config must use `version: '2.0'`

## Upgrading from v1.x to v2.x

If you're upgrading from v1.x, see the [Migration Guide](/guides/migration) for breaking changes and required configuration updates.

Key changes in v2.0:

- Config version changed to `version: '2.0'`
- Lane format now requires "Parent: Sublane" (e.g., `Framework: Core`)
- State directory is `.lumenflow/`

## Version Compatibility

All `@lumenflow/*` packages should be at the same version for best compatibility.

| Package                        | Current |
| ------------------------------ | ------- |
| `@lumenflow/core`              | 3.0.0   |
| `@lumenflow/cli`               | 3.0.0   |
| `@lumenflow/kernel`            | 3.0.0   |
| `@lumenflow/runtime`           | 3.0.0   |
| `@lumenflow/packs`             | 3.0.0   |
| `@lumenflow/mcp`               | 3.0.0   |
| `@lumenflow/memory`            | 3.0.0   |
| `@lumenflow/agent`             | 3.0.0   |
| `@lumenflow/initiatives`       | 3.0.0   |
| `@lumenflow/metrics`           | 3.0.0   |
| `@lumenflow/shims`             | 3.0.0   |
| `@lumenflow/control-plane-sdk` | 3.0.0   |

See the [Compatibility Matrix](/reference/compatibility) for full version details.

## Troubleshooting

### Upgrade command not found

If `pnpm lumenflow:upgrade` is not recognized, ensure you have `@lumenflow/cli` installed:

```bash
pnpm add -D @lumenflow/cli
```

### Package version mismatch

If you see version mismatch warnings, run the upgrade command again:

```bash
pnpm lumenflow:upgrade --latest
```

### docs:sync fails

If `docs:sync --force` fails, ensure the CLI is built:

```bash
pnpm build --filter @lumenflow/cli
pnpm exec lumenflow docs:sync --force
```

## Next Steps

- [Changelog](/reference/changelog) — See what's new in each version
- [Compatibility Matrix](/reference/compatibility) — Version requirements
- [Migration Guide](/guides/migration) — Upgrading from v1.x
