---
title: Upgrading LumenFlow
description: Upgrade to workspace-first LumenFlow v4.0.0
---

import { Steps, Aside, Badge } from '@astrojs/starlight/components';

<Badge text="v4.0.0" variant="danger" />

Version 4.0.0 is a **major release**. It hard-cuts to workspace-first runtime semantics.

## What Changed in v4.0.0

- `workspace.yaml` is now the canonical runtime config.
- Split onboarding entrypoints are retired as primary paths:
  - `onboard`
  - `lumenflow-onboard`
  - `workspace:init`
- Canonical bootstrap path is now:

```bash
npx lumenflow
```

- `config:set` and `config:get` now operate on `workspace.yaml > software_delivery`.
- Cloud control-plane setup is first-class via:

```bash
pnpm cloud:connect
# or: npx lumenflow cloud connect
```

<Aside type="caution" title="Breaking behavior">
  Existing docs/scripts that call `onboard` or `workspace:init` should be updated to `npx
  lumenflow`.
</Aside>

## Upgrade Path (Recommended)

<Steps>
1. **Upgrade packages**

   ```bash
   pnpm lumenflow:upgrade --latest
   ```

2. **Migrate legacy config into workspace.yaml** (if you still have `.lumenflow.config.yaml`)

   ```bash
   pnpm lumenflow:upgrade config:migrate-workspace
   ```

3. **Re-run canonical bootstrap in merge mode**

   ```bash
   pnpm exec lumenflow --client claude --merge
   # replace "claude" with your client: cursor, windsurf, codex, cline, aider, none
   ```

4. **Verify runtime health**

   ```bash
   pnpm exec lumenflow-doctor
   ```

5. **Refresh agent docs/templates**

   ```bash
   pnpm exec lumenflow docs:sync --force
   ```

</Steps>

## Post-Upgrade Checks

- Validate workspace-first config reads:

```bash
pnpm config:get --key software_delivery.methodology.testing
```

- Validate workspace-first config writes:

```bash
pnpm config:set --key software_delivery.gates.minCoverage --value 90
```

- Optional cloud connect verification:

```bash
pnpm cloud:connect \
  --endpoint https://control-plane.example.com \
  --org-id YOUR_ORG_ID \
  --project-id YOUR_PROJECT_ID \
  --token-env LUMENFLOW_CONTROL_PLANE_TOKEN
```

## Migration Notes

- Legacy split onboarding commands are still present only as **legacy guidance shims**.
- Runtime behavior no longer depends on `.lumenflow.config.yaml`.
- Keep all LumenFlow packages on the same major version for compatibility.

## Troubleshooting

### `workspace.yaml` missing

Run canonical bootstrap:

```bash
npx lumenflow
```

### Old docs/scripts still call `onboard`

Replace with:

```bash
npx lumenflow
```

### Need to migrate existing `.lumenflow.config.yaml`

```bash
pnpm lumenflow:upgrade config:migrate-workspace
```

## Next Steps

- [CLI Reference](/reference/cli) — full command surface
- [Changelog](/reference/changelog) — release notes and breaking changes
