---
title: Quickstart (Agents)
description: Canonical setup guide for AI agents. Session 0 = LumenFlow only.
---

import { Steps, Aside, Badge } from '@astrojs/starlight/components';

## Read this first: Your purpose

You are here to set up LumenFlow. That is your **only** job in Session 0.

- ✅ Initialize LumenFlow in this repo
- ✅ Create an Initiative if the user provided a vision doc or multi-phase plan
- ✅ Create the first Work Unit (WU)
- ✅ Stop and hand off
- ❌ Do not implement features
- ❌ Do not write schemas/models/components
- ❌ Do not refactor or optimize code
- ❌ Do not proceed past Session 0 without explicit user approval

<Aside type="danger" title="Session 0 ends after setup">
  Do not write feature code. Implementation begins only after a Work Unit is claimed in Session 1.
</Aside>

<Aside type="tip" title="Running setup yourself?">
  Use the [Manual Quickstart (Humans)](/guides/manual-quickstart/) if you are not an AI agent.
</Aside>

## Session 0 Exit Criteria (Must be true)

1. LumenFlow installed and activated. CLI installed; `pnpm exec lumenflow --full --client <client>` completed; `pnpm wu:create --help` works.
2. LumenFlow enforced. Run `pnpm exec lumenflow-doctor`; errors are blockers. Work happens only in claimed WUs; no edits on main; gates run before `wu:done`.
3. Next step chosen with the user. Create one of: Discovery WU, concrete task WU, or Initiative for multi-phase vision. Stop after selection.

<Aside type="danger" title="Enforcement warnings are blockers">
  If init or `lumenflow-doctor` reports errors (e.g., Husky hooks not installed, safe-git missing),
  do not declare setup complete. Surface the errors, ask the user to resolve or acknowledge, and
  stop.
</Aside>

## If `lumenflow-doctor` reports errors

Stop and ask for approval before fixing anything. If the user approves, only run the fixes below:

**Husky hooks (required):**

```bash
pnpm add -D husky
pnpm exec husky init
```

**Safe-git wrapper (required):**

```bash
mkdir -p scripts
cp node_modules/@lumenflow/cli/bin/safe-git scripts/safe-git
chmod +x scripts/safe-git
```

Re-run `pnpm exec lumenflow-doctor`. If errors remain, stop and ask for direction.

Lane overlap warnings are not fixed in Session 0. Create a follow-up WU later. Do not edit
`.lumenflow.config.yaml` in Session 0.

## Decide the next step (with the user)

Use this ladder after setup:

1. **Multi-phase vision or roadmap** → Create an Initiative first, then a Discovery WU to translate it into a small backlog.
2. **Clear single task** → Create one concrete WU for that task.
3. **Unclear or exploratory** → Create a Discovery WU: "Define next steps after LumenFlow setup."

Stop after creating the next artifact. Do not claim a WU without explicit approval.

If the user says the project is multi-phase or shares a vision doc, create an Initiative before any WU:

```bash
pnpm initiative:create \
  --id INIT-001 \
  --slug "project-name" \
  --title "Project Name" \
  --owner "team@example.com"

pnpm initiative:edit --id INIT-001 --add-phase "Phase 1: MVP"
pnpm initiative:edit --id INIT-001 --add-phase "Phase 2: Core"
```

## Allowed commands (Session 0 only)

If a command is not listed here, do not run it in Session 0.

| Command                                                        | Purpose                                     |
| -------------------------------------------------------------- | ------------------------------------------- |
| `node --version`                                               | Verify toolchain                            |
| `pnpm --version`                                               | Verify toolchain                            |
| `git --version`                                                | Verify toolchain                            |
| `git init`                                                     | New project only                            |
| `pnpm init -y`                                                 | Only if no `package.json` and user approved |
| `pnpm add -D @lumenflow/cli`                                   | Install LumenFlow CLI                       |
| `pnpm exec lumenflow --full --client <client>`                 | Initialize LumenFlow (new repos)            |
| `pnpm exec lumenflow --full --client <client> --merge`         | Initialize LumenFlow (existing repos)       |
| `pnpm exec lumenflow-doctor`                                   | Verify enforcement (errors block)           |
| `pnpm wu:create --help`                                        | Verify scripts were injected                |
| `pnpm add -D husky`                                            | Fix enforcement (only with approval)        |
| `pnpm exec husky init`                                         | Fix enforcement (only with approval)        |
| `mkdir -p scripts`                                             | Fix enforcement (only with approval)        |
| `cp node_modules/@lumenflow/cli/bin/safe-git scripts/safe-git` | Fix enforcement (only with approval)        |
| `chmod +x scripts/safe-git`                                    | Fix enforcement (only with approval)        |
| `pnpm initiative:create ...`                                   | Create an initiative                        |
| `pnpm initiative:edit ...`                                     | Add initiative phases                       |
| `pnpm wu:create ...`                                           | Create first WU                             |
| `pnpm wu:status --id WU-XXX`                                   | Confirm WU status                           |
| `pnpm wu:claim --id WU-XXX --lane "..."`                       | Only if user explicitly says "proceed"      |
| `git add -A && git commit -m "..."`                            | Commit scaffold/LumenFlow setup only        |

Read-only commands allowed: `pwd`, `ls`, `cat`, `rg`, `git status`.

## Session 0: New project

<Steps>
1. **Verify toolchain**

```bash
node --version   # Requires 22.0.0+
pnpm --version   # Requires 9.0.0+
git --version    # Requires 2.0.0+
```

2. **Initialize the repo** (only if empty)

   ```bash
   git init
   ```

   <Aside type="caution" title="Non-Node projects still need a package.json">
     For .NET, Go, Python, etc., LumenFlow uses `package.json` only to install the CLI and scripts.
     If there is no `package.json`, ask permission to run `pnpm init -y`. Do not scaffold a Node
     stack or change the project's framework.
   </Aside>

3. **Scaffold a tech stack only if the user explicitly asked**

   Keep this minimal. Do not add feature code.

   ```bash
   pnpm create next-app@latest . --typescript --tailwind --eslint --app --yes
   # or: pnpm create vite@latest . --template react-ts
   # or: pnpm create astro@latest . --template minimal
   ```

   If you scaffolded, commit the baseline:

   ```bash
   git add -A && git commit -m "chore: initial scaffold"
   ```

4. **Install LumenFlow**

   ```bash
   pnpm add -D @lumenflow/cli
   ```

5. **Initialize LumenFlow**

   ```bash
   pnpm exec lumenflow --full --client claude
   # or: pnpm exec lumenflow --full --client codex
   # or: pnpm exec lumenflow --full --client cursor
   # or: pnpm exec lumenflow --full --client windsurf
   # or: pnpm exec lumenflow --full --client cline
   ```

6. **Verify scripts were injected**

   ```bash
   pnpm wu:create --help
   ```

7. **Commit LumenFlow setup**

   ```bash
   git add -A && git commit -m "chore: add lumenflow"
   ```

8. **Create initiative (only if a vision doc exists)**

   ```bash
   pnpm initiative:create \
     --id INIT-001 \
     --slug "project-name" \
     --title "Project Name" \
     --owner "team@example.com"

   pnpm initiative:edit --id INIT-001 --add-phase "Phase 1: Foundation"
   pnpm initiative:edit --id INIT-001 --add-phase "Phase 2: Core Features"
   ```

9. **Create the first WU (do not implement)**

   ```bash
   pnpm wu:create \
     --lane "<Lane from .lumenflow.config.yaml>" \
     --title "<Short task title>" \
     --type feature \
     --exposure backend-only \
     --description "<What this task accomplishes>" \
     --acceptance "<Measurable success criterion>"
   ```

   If you created an initiative, add: `--initiative INIT-001`.

   Do **not** claim or implement unless the user explicitly says "proceed".

</Steps>

## Session 0: Existing project

<Steps>
1. **Verify toolchain**

```bash
node --version   # Requires 22.0.0+
pnpm --version   # Requires 9.0.0+
git --version    # Requires 2.0.0+
```

2. **Install LumenFlow**

   ```bash
   pnpm add -D @lumenflow/cli
   ```

3. **Initialize with merge mode**

   ```bash
   pnpm exec lumenflow --full --client claude --merge
   ```

4. **Verify scripts were injected**

   ```bash
   pnpm wu:create --help
   ```

5. **Commit LumenFlow setup**

   ```bash
   git add -A && git commit -m "chore: add lumenflow"
   ```

6. **Create initiative (optional)**

   If the user provided a vision doc or multi-phase plan:

   ```bash
   pnpm initiative:create \
     --id INIT-001 \
     --slug "project-name" \
     --title "Project Name" \
     --owner "team@example.com"
   ```

7. **Create the first WU (do not implement)**

   ```bash
   pnpm wu:create \
     --lane "<Lane from .lumenflow.config.yaml>" \
     --title "<Short task title>" \
     --type feature \
     --exposure backend-only \
     --description "<What this task accomplishes>" \
     --acceptance "<Measurable success criterion>"
   ```

   If you created an initiative, add: `--initiative INIT-001`.

   Do **not** claim or implement unless the user explicitly says "proceed".

</Steps>

## Session 0 handoff template

Copy this template and fill in the values:

```markdown
## Session 0 Complete - Handoff

### Current State

- LumenFlow initialized: Yes
- Initiative: INIT-001 "Project Name" (if created)
- Current WU: WU-0001 "Your task title" (created, not claimed)
- Repo: /path/to/repo

### Next Session Instructions

1. Read `LUMENFLOW.md` in the project root
2. Check status: `pnpm wu:status --id WU-0001`
3. If user confirms, claim WU: `pnpm wu:claim --id WU-0001 --lane "..."`
4. Enter worktree: `cd worktrees/<lane>-wu-0001`
5. Implement the WU acceptance criteria
6. Run gates: `pnpm wu:prep --id WU-0001`
7. Complete (from main): `pnpm wu:done --id WU-0001`

### Critical Rules

- ALL implementation work happens in WUs
- NEVER edit files on main branch
- NEVER manually edit WU YAML files
- ALWAYS run `wu:done` to complete work
```

<Aside type="danger" title="Session 0 stops here">
  Do not write feature code in Session 0. Wait for explicit approval before claiming a WU.
</Aside>

---

## DO NOT list

These actions will break the workflow.

| Do Not                                   | Instead                                        |
| ---------------------------------------- | ---------------------------------------------- |
| Work on main branch                      | Work in a worktree after `wu:claim`            |
| Manually create WU YAML files            | Use `pnpm wu:create`                           |
| Manually edit WU YAML status             | Use `pnpm wu:edit --status`                    |
| Use `git worktree add` directly          | Use `pnpm wu:claim`                            |
| Run `wu:done` from a worktree            | Run from main checkout                         |
| Use `--no-verify` to skip hooks          | Fix hook failures properly                     |
| Manually edit backlog.md or status.md    | Let CLI regenerate from state                  |
| Manually edit `.lumenflow.config.yaml`   | Use CLI commands and `lumenflow-doctor`        |
| Run `pnpm init` by default               | Only if user requested a bare Node project     |
| Run `pnpm exec lumenflow doctor`         | Use `pnpm exec lumenflow-doctor`               |
| Fix enforcement without approval         | Ask, then apply explicit fixes if approved     |
| Ask more than 2 setup questions          | Use defaults; ask only essential questions     |
| Scaffold a Node stack for non-Node repo  | Only scaffold the framework the user asked for |
| Scaffold tech stack after LumenFlow init | Scaffold before init, or skip                  |
| Write feature code before a WU exists    | Create a WU first                              |
| Continue after Session 0                 | Stop, hand off, and wait                       |

---

## After Session 0

All work flows through WUs and Initiatives only:

1. `pnpm wu:create`
2. `pnpm wu:claim` → enter worktree
3. Implement acceptance criteria
4. `pnpm wu:prep`
5. `pnpm wu:done`

If a user asks for work outside a WU, create a WU first and wait for approval.
