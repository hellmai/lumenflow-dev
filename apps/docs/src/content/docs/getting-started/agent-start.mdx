---
title: Agent Start Here
description: The strict, command-only guide for AI agents setting up LumenFlow projects
---

import { Steps, Aside, Badge } from '@astrojs/starlight/components';

<Aside type="tip" title="For AI Agents">
  This page is designed for AI agents executing setup commands. Every command is copy-paste ready.
  Execute in order. Do not skip steps. Trust the CLI output.
</Aside>

## Which situation are you in?

Choose your path:

- **New project** — You have a product vision or idea, no code yet
- **Existing project** — You have a codebase, want to add LumenFlow

---

## New Project Path

### Phase 1: Prerequisites

Verify these tools are installed.

```bash
node --version   # Requires 22.0.0+
pnpm --version   # Requires 9.0.0+
git --version    # Requires 2.0.0+
```

<Aside type="danger" title="Stop if any check fails">
  Install missing tools before proceeding.
</Aside>

### Phase 2: Scaffold Your Tech Stack

LumenFlow is framework-agnostic. Scaffold your project first, then add LumenFlow.

```bash
# Initialize git
git init

# Scaffold your framework (examples)
pnpm create next-app@latest . --typescript --tailwind --eslint --app --yes
# OR: pnpm create vite@latest . --template react-ts
# OR: pnpm create astro@latest . --template minimal

# Commit the baseline
git add -A && git commit -m "chore: initial scaffold"
```

<Aside type="caution" title="Tech stack comes first">
  LumenFlow uses your project structure for lane inference. Scaffold before initializing LumenFlow.
</Aside>

### Phase 3: Add LumenFlow

```bash
# Install CLI as dev dependency
pnpm add -D @lumenflow/cli

# Initialize LumenFlow (full mode, specify your AI client)
pnpm exec lumenflow --full --client claude-code
# OR: pnpm exec lumenflow --full --client codex
# OR: pnpm exec lumenflow --full --client cursor

# Verify scripts were injected
pnpm wu:create --help

# Commit LumenFlow setup
git add -A && git commit -m "chore: add lumenflow"
```

<Aside type="tip" title="Scripts are auto-injected">
  LumenFlow automatically adds scripts to package.json. Do not add them manually.
</Aside>

### Phase 4: Create Initiative (If You Have a Product Vision)

If the user provided a product vision, idea document, or multi-phase project:

```bash
pnpm initiative:create \
  --id INIT-001 \
  --title "Project Name" \
  --phase "Phase 1: Foundation" \
  --phase "Phase 2: Core Features" \
  --phase "Phase 3: Polish"
```

Skip this step for single-task work.

### Phase 5: Create and Claim First WU

```bash
# Create the first Work Unit
pnpm wu:create \
  --lane "Feature: Backend" \
  --title "Setup database and authentication" \
  --type feature \
  --exposure backend-only \
  --initiative INIT-001 \
  --description "Initialize database schema and auth system" \
  --acceptance "Database migrations run successfully" \
  --acceptance "Users can register and login" \
  --code-paths "src/db/" "src/auth/"

# Claim the WU (use the ID printed by wu:create)
pnpm wu:claim --id WU-0001 --lane "Feature: Backend"
```

### Phase 6: Session 0 Complete — Generate Handoff

You have reached the Session 0 stopping point. Generate a handoff for the next session.

Copy this template and fill in the values:

```markdown
## Session 0 Complete — Handoff

### Current State

- Initiative: INIT-001 "Project Name" created
- Current WU: WU-0001 "Setup database and authentication" claimed
- Worktree: worktrees/feature-backend-wu-0001
- Gates: Not yet run (new WU)

### Next Session Instructions

1. Read LUMENFLOW.md in the project root
2. Check status: `pnpm wu:status --id WU-0001`
3. Enter worktree: `cd worktrees/feature-backend-wu-0001`
4. Implement the WU acceptance criteria
5. Run gates: `pnpm wu:prep --id WU-0001`
6. Complete (from main): `pnpm wu:done --id WU-0001`

### Critical Rules

- ALL implementation work happens in WUs
- NEVER edit files on main branch
- NEVER manually edit WU YAML files
- ALWAYS run wu:done to complete work
```

<Aside type="danger" title="Session 0 stops here">
  Do not write feature code in Session 0. Feature implementation begins in Session 1, after the user
  reviews the setup.
</Aside>

---

## Existing Project Path

### Step 1: Prerequisites

Verify these tools are installed.

```bash
node --version   # Requires 22.0.0+
pnpm --version   # Requires 9.0.0+
git --version    # Requires 2.0.0+
```

### Step 2: Add LumenFlow

```bash
# Install CLI as dev dependency
pnpm add -D @lumenflow/cli

# Initialize LumenFlow
pnpm exec lumenflow --full --client claude-code

# Verify scripts were injected
pnpm wu:create --help

# Commit LumenFlow setup
git add -A && git commit -m "chore: add lumenflow"
```

### Step 3: Create First WU

```bash
# Create a WU for your task
pnpm wu:create \
  --lane "Feature: Backend" \
  --title "Your task title" \
  --type feature \
  --exposure backend-only \
  --description "What this task accomplishes" \
  --acceptance "Measurable success criterion"

# Claim the WU
pnpm wu:claim --id WU-0001 --lane "Feature: Backend"
```

### Step 4: Work in Worktree

```bash
# Enter the worktree
cd worktrees/feature-backend-wu-0001

# Do your work here
# ...

# Run gates
pnpm wu:prep --id WU-0001

# Complete (from main checkout)
cd /path/to/main
pnpm wu:done --id WU-0001
```

---

## DO NOT List

These actions will break the workflow.

| Do Not                                   | Instead                                  |
| ---------------------------------------- | ---------------------------------------- |
| Work on main branch                      | Work in worktree after `wu:claim`        |
| Manually create WU YAML files            | Use `pnpm wu:create`                     |
| Manually edit WU YAML status             | Use `pnpm wu:edit --status`              |
| Use `git worktree add` directly          | Use `pnpm wu:claim`                      |
| Run `wu:done` from worktree              | Run from main checkout                   |
| Use `--no-verify` to skip hooks          | Fix hook failures properly               |
| Manually edit backlog.md or status.md    | Let CLI regenerate from state            |
| Write feature code before WU is claimed  | Create and claim WU first                |
| Ask more than 2 setup questions          | Use defaults, refine later               |
| Scaffold tech stack after lumenflow init | Scaffold first for better lane inference |

---

## Command Quick Reference

| Command                      | Description                 |
| ---------------------------- | --------------------------- |
| `pnpm exec lumenflow`        | Initialize LumenFlow        |
| `pnpm initiative:create ...` | Create multi-phase project  |
| `pnpm wu:create ...`         | Create Work Unit            |
| `pnpm wu:claim --id WU-XXX`  | Claim WU, create worktree   |
| `pnpm wu:status --id WU-XXX` | Check WU state and location |
| `pnpm wu:prep --id WU-XXX`   | Run gates in worktree       |
| `pnpm wu:done --id WU-XXX`   | Complete WU (from main)     |
| `pnpm lumenflow commands`    | List all available commands |

---

## Next Steps After Session 0

- [Idea to Shipping](/guides/idea-to-shipping) — Full project lifecycle
- [Initiatives](/guides/initiatives) — Multi-phase project management
- [Sizing WUs](/guides/sizing) — How to scope Work Units
- [AI Agent Integration](/guides/ai-agents) — Agent-specific patterns
