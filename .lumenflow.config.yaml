version: '2.0'
project: lumenflow

# WU-1022: Lane enforcement configuration
# Controls how lane format validation behaves
lanes:
  enforcement:
    # When true, lanes MUST use "Parent: Sublane" format if parent has taxonomy
    require_parent: true
    # When false, only lanes in the taxonomy are allowed. When true, custom lanes can be used.
    allow_custom: false

  # Lane definitions with full "Parent: Sublane" format
  # These map to the taxonomy in .lumenflow.lane-inference.yaml
  definitions:
    - name: 'Framework: Core'
      wip_limit: 1
      code_paths:
        - 'packages/@lumenflow/core/**'

    - name: 'Framework: CLI'
      wip_limit: 1
      code_paths:
        - 'packages/@lumenflow/cli/**'

    - name: 'Framework: Memory'
      wip_limit: 1
      code_paths:
        - 'packages/@lumenflow/memory/**'

    - name: 'Framework: Agent'
      wip_limit: 1
      code_paths:
        - 'packages/@lumenflow/agent/**'

    - name: 'Framework: Metrics'
      wip_limit: 1
      code_paths:
        - 'packages/@lumenflow/metrics/**'

    - name: 'Framework: Initiatives'
      wip_limit: 1
      code_paths:
        - 'packages/@lumenflow/initiatives/**'

    - name: 'Framework: Shims'
      wip_limit: 1
      code_paths:
        - 'packages/@lumenflow/shims/**'

    - name: 'Operations: Infrastructure'
      wip_limit: 1
      code_paths:
        - 'apps/**'
        - 'actions/**'

    - name: 'Operations: CI/CD'
      wip_limit: 1
      code_paths:
        - '.github/**'

    - name: 'Content: Documentation'
      wip_limit: 1
      code_paths:
        - 'docs/**'

git:
  main_branch: main
  branch_pattern: 'lane/{lane}/{wu_id}'

directories:
  wu_specs: 'docs/04-operations/tasks/wu'
  backlog: 'docs/04-operations/tasks/backlog.md'
  status: 'docs/04-operations/tasks/status.md'
  stamps: '.beacon/stamps'
  skillsDir: '.claude/skills'
  agentsDir: '.claude/agents'

worktree_pattern: 'worktrees/{lane}-{wu_id}'

# WU-1053: Agent and skill configuration for AI clients
agents:
  defaultClient: 'claude-code'
  clients:
    claude-code:
      preamble: true
      skillsDir: '.claude/skills'
      agentsDir: '.claude/agents'
      skills:
        instructions: 'Load skills based on WU context:'
        recommended:
          - wu-lifecycle
          - worktree-discipline
        byLane:
          'Framework: Core':
            - tdd-workflow
            - lumenflow-gates
          'Framework: CLI':
            - tdd-workflow
            - lumenflow-gates
          'Content: Documentation':
            - worktree-discipline
          'Operations: Infrastructure':
            - orchestration
      blocks:
        - title: 'Claude Code Best Practices'
          content: |
            - Use TodoWrite for multi-step tasks
            - Run gates before wu:done
            - Never use --no-verify
            - Load skills via /skill <name>
    codex-cli:
      preamble: true
      skillsDir: '.claude/skills'
    gemini-cli:
      preamble: true
      skillsDir: '.claude/skills'
